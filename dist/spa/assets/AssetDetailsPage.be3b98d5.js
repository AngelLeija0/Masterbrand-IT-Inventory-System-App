import{d as Be,x as Ke,_ as Ie,y as w,z as j,Q as R,B as ce,r as x,w as ke,J as T,N as B,K as V,f as p,C,E as ie,o as ei,G as re,O as Se,F as Me,M as He,L as me,D as Ge,aE as ti,aV as ii,aW as oi,k as ni,c as si,h as Et}from"./index.d76d729d.js";import{Q as ai}from"./QSpinnerDots.a9a067c5.js";import{Q as de,u as ri}from"./use-quasar.8b1fb4cd.js";import{a as $e,b as te,Q as li}from"./QPage.90f527e3.js";import{w as _e,Q as Te}from"./QTooltip.e068c045.js";import{Q as Fe,a as Lt,u as di,b as ci}from"./QFile.e7d124ba.js";import{C as et}from"./ClosePopup.88557c7d.js";import{serverURL as tt,api as Ce}from"./axios.d5763ff0.js";import{d as Nt,f as ui,P as fi}from"./PrimaryButton.ed2de242.js";import{M as hi}from"./MoreOptionsButton.8d7956dd.js";import{D as gi}from"./DialogConfirmDelete.f053ba81.js";import{Q as Ve}from"./QInput.256b5391.js";import{a as ht,b as Qe,c as pi}from"./QTable.d3ac5408.js";import"./use-dark.dd39b0a6.js";import"./uid.55d387d1.js";const mi=Be({name:"PrimaryButton",setup(){return{router:Ke()}},methods:{goBack(){this.$router.go(-1)}}});function vi(t,e,i,o,n,s){return w(),j(R,{flat:"",dense:"",padding:"sm sm sm xs",label:"Regresar",size:"0.75rem",icon:"chevron_left",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:t.goBack},null,8,["onClick"])}var bi=Ie(mi,[["render",vi]]);const yi=Be({name:"SecondaryNavbarButton",props:{label:{type:String},active:{type:String},borderPosition:{type:String}}});function wi(t,e,i,o,n,s){return w(),j(R,{label:t.label,size:"0.9rem",align:"left",flat:"",padding:"sm md",color:t.active?"dark":"grey-8",style:ce({borderTop:t.borderPosition==="top"&&t.active==!0?"5px solid #1565c0":"5px solid #f5f5f5",borderBottom:t.borderPosition==="bottom"&&t.active==!0?"5px solid #1565c0":"5px solid #f5f5f5",borderRight:t.borderPosition==="right"&&t.active==!0?"5px solid #1565c0":"5px solid #f5f5f5",borderLeft:t.borderPosition==="left"&&t.active==!0?"5px solid #1565c0":"5px solid #f5f5f5",textTransform:"capitalize",fontWeight:t.active?"600":""})},null,8,["label","color","style"])}var Ai=Ie(yi,[["render",wi]]);const Ci=Be({name:"AssetInput",props:{label:{type:String},modelValue:{type:String},modelKey:{type:String},editing:{type:Boolean}},setup(t){const e=x(i());function i(){const a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),l=window.innerWidth<768;return a||l}window.addEventListener("resize",()=>{e.value=i()});const o=x(t.modelValue),n=x(t.modelKey),s=x(t.editing),r=x({name:[a=>!!a,a=>a.length<30,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],description:[a=>!!a,a=>a.length<80,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],"status.description":[a=>!!a,a=>a.length<50,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],"status.date":[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],manufacturer:[a=>!!a,a=>a.length<30,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],model:[a=>!!a,a=>a.length<30,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],serial_number:[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],purchase_from:[a=>!!a,a=>a.length<30,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],purchase_date:[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],cost:[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;'<>?~`]/gi.test(a)],warranty_info:[a=>!!a,a=>a.length<30,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],warranty_expiration_date:[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],current_employee:[a=>!!a,a=>a.length<50,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],operating_system:[a=>!!a,a=>a.length<20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)],ram:[a=>!!a,a=>a.length>20,a=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(a)]});return ke(()=>t.modelValue,a=>{o.value=a}),ke(()=>t.modelKey,a=>{n.value=a}),ke(()=>t.editing,a=>{s.value=a}),{isMobile:e,localValue:o,keyValue:n,isEditing:s,inputRulesDictionary:r}},methods:{toggleEditing(){this.$emit("update-editing",this.isEditing)},updateValue(){this.$emit("update-input",this.keyValue,this.localValue)}}}),ki={class:"flex justify-between items-center q-py-sm",style:{"border-bottom":"1px solid rgb(239, 239, 239)",width:"100%"}};function Ii(t,e,i,o,n,s){return w(),T("div",ki,[B("div",{class:"q-pr-md text-grey-14",style:ce({width:t.isMobile?"100%":"30%"})},V(t.label),5),p(Ve,{modelValue:t.localValue,"onUpdate:modelValue":e[0]||(e[0]=r=>t.localValue=r),dense:"",borderless:"",readonly:!t.isEditing||t.label==="Categor\xEDa",rules:t.inputRulesDictionary[t.keyValue],onChange:t.updateValue,"hide-bottom-space":"","input-style":"font-weight: 500;",style:ce({width:t.isMobile?"70%":"50%"})},null,8,["modelValue","readonly","rules","onChange","style"]),p(R,{icon:"edit",flat:"",round:"",size:"12px",color:t.isEditing?"primary":"grey-14",onClick:t.toggleEditing,disabled:t.label==="Categor\xEDa"},{default:C(()=>[t.label==="Categor\xEDa"?(w(),j(_e,{key:0,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("No es posible editar la categoria")]),_:1})):t.isEditing?(w(),j(_e,{key:2,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("Cerrar editor")]),_:1})):(w(),j(_e,{key:1,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("Editar")]),_:1}))]),_:1},8,["color","onClick","disabled"])])}var Ei=Ie(Ci,[["render",Ii]]);const Di=Be({name:"AssetSelecInput",props:{label:{type:String},modelValue:{type:String},modelKey:{type:String},options:{type:Array},editing:{type:Boolean}},setup(t){const e=x(i());function i(){const a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),l=window.innerWidth<768;return a||l}window.addEventListener("resize",()=>{e.value=i()});const o=x(t.modelValue),n=x(t.modelKey),s=x(t.editing),r=x(null);return ke(()=>t.modelValue,a=>{o.value=a,r.value||(r.value=a)}),ke(()=>t.modelKey,a=>{n.value=a}),ke(()=>t.editing,a=>{s.value=a,a||(o.value=r.value)}),ei(()=>{r.value=t.modelValue}),{isMobile:e,localValue:o,initialValue:r,keyValue:n,isEditing:s}},methods:{toggleEditing(){this.$emit("update-editing",this.isEditing)},updateValue(){this.$emit("update-input",this.keyValue,this.localValue)}}}),$i={class:"flex justify-between items-center q-py-sm",style:{"border-bottom":"1px solid rgb(239, 239, 239)",width:"100%"}};function Pi(t,e,i,o,n,s){return w(),T("div",$i,[B("div",{class:"q-pr-md text-grey-14",style:ce({width:t.isMobile?"100%":"30%"})},V(t.label),5),p(ht,{modelValue:t.localValue,"onUpdate:modelValue":[e[0]||(e[0]=r=>t.localValue=r),t.updateValue],options:t.options,dense:"",borderless:"",readonly:!t.isEditing||t.label==="Categor\xEDa","hide-dropdown-icon":"","input-style":"font-weight: 500;",class:"span-selected-option",style:ce({width:t.isMobile?"70%":"50%"})},null,8,["modelValue","options","readonly","onUpdate:modelValue","style"]),p(R,{icon:"edit",flat:"",round:"",size:"12px",color:t.isEditing?"primary":"black",onClick:t.toggleEditing,disabled:t.label==="Categor\xEDa"},{default:C(()=>[t.label==="Categor\xEDa"?(w(),j(_e,{key:0,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("No es posible editar la categoria")]),_:1})):t.isEditing?(w(),j(_e,{key:2,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("Cerrar editor")]),_:1})):(w(),j(_e,{key:1,class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("Editar")]),_:1}))]),_:1},8,["color","onClick","disabled"])])}var Si=Ie(Di,[["render",Pi]]);const Bi=Be({name:"AssetInfo",props:{modelInfo:{type:Object}},components:{AssetInput:Ei,AssetSelectInput:Si},data(){return{highlightedImageIndex:-1}},setup(t){var _;const e=x(i());function i(){const h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),v=window.innerWidth<768;return h||v}window.addEventListener("resize",()=>{e.value=i()});const o=x(tt),n=Ke(),s=x(t.modelInfo),r=x({...s.value}),a=x();(_=s.value.images)!=null&&_.default_image&&(a.value=!0),ke(t.modelInfo,h=>{s.value=h});const l=x(!1),d=x(!1),u=x(),c=x(["Activo","Inactivo","Roto","Con stock","Bajo stock","Sin stock"]),m=x([]);A();function A(){var v;const h=(v=s.value)==null?void 0:v.category;Ce.get(`./categories/name/${h}`).then(I=>{const b=I.data.properties.map(y=>y.key);$(Object.keys(s.value),b)}).catch(I=>{console.log(I)})}function $(h,v){const I=[...new Set([...h,...v])],f=[];I.map(b=>{if(b!=="_id"&&b!=="images"&&b!=="__v"&&b!=="actions"&&b!=="created_at"&&b!=="updated_at"&&b!=="status"&&b!=="status.name")return f.push(b)}),m.value=f}function P(h){return Nt.formatDate(h,"DD/MMMM/YYYY - HH:mm",{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]})}return{isMobile:e,router:n,originalInputInfo:r,inputInfo:s,isEditing:l,isEditingImage:d,inputNewImage:u,imageServer:o,statusOptions:c,allProperties:m,formatDate:P,defaultImageFounded:a}},methods:{updateInputInfo(t,e){t==="status.name"?(this.originalInputInfo.status.name=this.inputInfo.status.name,this.inputInfo.status.name=e):this.inputInfo[t]=e},updateEditing(t){this.isEditing=!t,this.inputInfo={...this.originalInputInfo},this.$emit("update-info")},saveAsset(){const t=this.inputInfo;Ce.patch(`./assets/update/${t._id}`,t).then(e=>{const i=e.data;i?(this.inputInfo=i,this.originalInputInfo={...this.inputInfo},this.isEditing=!1,this.$emit("update-info"),this.$q.notify({type:"positive",message:"Modificado correctamente.",timeout:2e3})):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(e=>{this.$q.notify({type:"negative",message:`Ha ocurrido un error. ${e.message}`,timeout:2e3})})},setNewDefaultImge(t){this.inputInfo.images.default_image=t;const e=this.inputInfo;try{Ce.patch(`./assets/update/${e._id}`,e).then(i=>{const o=i.data;o&&(this.inputInfo=o,this.isEditingImage=!1,this.$q.notify({type:"positive",message:"Modificado correctamente.",timeout:2e3}))}).catch(i=>{this.$q.notify({type:"negative",message:`Ha ocurrido un error. ${i.message}`,timeout:2e3})})}catch(i){this.$q.notify({type:"negative",message:`Ha ocurrido un error. Error: ${i.message}`,timeout:2e3})}},defineLabelFromProperty(t){return{_id:"ID",category:"Categor\xEDa",images:"Im\xE1genes",description:"Descripci\xF3n",manufacturer:"Fabricante",model:"Modelo",serial_number:"N\xFAmero de serie",purchase_from:"Lugar de compra",purchase_date:"Fecha de compra",cost:"Costo",warranty_info:"Informaci\xF3n de garant\xEDa",warranty_expiration_date:"Fecha de vencimiento de la garant\xEDa",operating_system:"S/O",ip_address:"Direcci\xF3n IP",ram:"RAM",location:"Ubicaci\xF3n",location_extra_info:"Informaci\xF3n adicional de ubicaci\xF3n",current_employee:"Empleado actual",actions:"Acciones",status:"Estado",name:"Nombre",date:"Fecha",network_status:"Estado de red",created_at:"Creado el",updated_at:"Actualizado el"}[t]||t},cancelEdit(){this.isEditing=!1,this.inputInfo={...this.originalInputInfo}},uploadNewImage(){const t=this.inputInfo,e=new FormData;e.append("attachments",this.inputNewImage),Ce.patch(`./assets/update/add-new-image/${t._id}`,e).then(i=>{const o=i.data;o?(this.inputInfo=o,this.originalInputInfo={...this.inputInfo},this.isEditingImage=!1,this.inputNewImage=null,this.$emit("update-info"),this.$q.notify({type:"positive",message:"Imagen agregada correctamente.",timeout:2e3})):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(i=>{console.log(i),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})},handleImageError(){this.defaultImageFounded=!1,this.$q.notify({type:"warning",message:"Error al cargar la imagen por defecto.",timeout:2e3})}}}),zt=t=>(ii("data-v-52ee74a6"),t=t(),oi(),t),xi={class:"row"},Mi={class:"col-12"},Ti={class:"row"},qi={class:"col-md-6 col-sm-6 col-12 flex justify-center text-center q-pa-md items-start"},_i={class:"col-md-6 col-sm-6 col-12 bg-grey-2 q-pa-md",style:{"border-radius":"10px"}},Li=zt(()=>B("div",{class:"text-h6"},"Estado",-1)),Ni={class:"col-12 q-pt-sm"},zi={class:"row flex justify-between"},Vi={class:"col-12 q-px-md q-pt-md flex justify-end"},Fi=zt(()=>B("div",{class:"text-h6",style:{"padding-top":"0"}},"Imagenes",-1)),Oi=["onMouseenter","onClick"],Ri={key:0,class:"image-circle-hover"};function Ui(t,e,i,o,n,s){var l;const r=re("AssetSelectInput"),a=re("AssetInput");return w(),T(Me,null,[B("div",xi,[B("div",Mi,[B("div",Ti,[B("div",qi,[t.defaultImageFounded?(w(),j(Fe,{key:0,class:"q-pa-md q-mx-sm",src:t.imageServer+"/uploads/attachments/"+((l=t.inputInfo.images)==null?void 0:l.default_image),"spinner-color":"primary",style:{"max-width":"260px"},onError:t.handleImageError},null,8,["src","onError"])):(w(),j(Se,{key:1,name:"image",size:"180px",class:"q-pa-md q-mx-sm",style:{"max-width":"260"}})),p(R,{icon:"edit",flat:"",round:"",size:"12px",color:t.isEditingImage?"primary":"black",onClick:e[0]||(e[0]=d=>t.isEditingImage=!0)},null,8,["color"])]),B("div",_i,[Li,(w(!0),T(Me,null,He(Object.keys(t.inputInfo.status),(d,u)=>(w(),T("div",{key:u+1},[d==="name"?(w(),j(r,{key:0,label:"Estado",options:t.statusOptions,modelKey:"status.name",modelValue:t.inputInfo.status.name,editing:t.isEditing,onUpdateInput:t.updateInputInfo,onUpdateEditing:t.updateEditing},null,8,["options","modelKey","modelValue","editing","onUpdateInput","onUpdateEditing"])):(w(),j(a,{key:1,label:t.defineLabelFromProperty(d),modelKey:"status."+d,modelValue:new RegExp("date").test(d)?t.formatDate(t.inputInfo.status[d]):t.inputInfo.status[d],editing:t.isEditing,onUpdateInput:t.updateInputInfo,onUpdateEditing:t.updateEditing},null,8,["label","modelKey","modelValue","editing","onUpdateInput","onUpdateEditing"]))]))),128))])])]),B("div",Ni,[B("div",zi,[(w(!0),T(Me,null,He(t.allProperties,(d,u)=>(w(),T("div",{class:"col-md-6 col-12 q-px-md",key:u+1},[p(a,{label:t.defineLabelFromProperty(d),modelKey:d,modelValue:new RegExp("date").test(d)?t.formatDate(t.inputInfo[d]):t.inputInfo[d],editing:t.isEditing,onUpdateInput:t.updateInputInfo,onUpdateEditing:t.updateEditing},null,8,["label","modelKey","modelValue","editing","onUpdateInput","onUpdateEditing"])]))),128)),t.isEditing?(w(),T("div",{key:0,class:"col-12 flex q-px-md q-pt-lg",style:ce({justifyContent:t.isMobile?"center":"end"})},[p(ui,{flat:""},{default:C(()=>[p(R,{class:"q-ma-xs",label:"Guardar",color:"primary","icon-right":"save",size:t.isMobile?"0.725rem":"0.85rem",style:{"text-transform":"capitalize","border-radius":"5px"},onClick:e[1]||(e[1]=d=>t.saveAsset())},null,8,["size"]),p(R,{class:"q-ma-xs",label:"Cancelar",flat:"",onClick:e[2]||(e[2]=d=>t.cancelEdit()),size:t.isMobile?"0.725rem":"0.85rem",style:{"text-transform":"capitalize","border-radius":"5px"}},null,8,["size"])]),_:1})],4)):me("",!0)])]),B("div",Vi,[B("div",{class:"full-width text-grey-14",style:ce({fontSize:t.isMobile?"12px":"14px",textAlign:t.isMobile?"start":"end"})},"Creado el "+V(t.formatDate(t.inputInfo.created_at)),5),t.inputInfo.updated_at?(w(),T("div",{key:0,class:"full-width text-grey-14",style:ce({fontSize:t.isMobile?"12px":"14px",textAlign:t.isMobile?"start":"end",paddingTop:t.isMobile?"5px":""})}," Ultima modificacion el "+V(t.formatDate(t.inputInfo.updated_at)),5)):(w(),T("div",{key:1,class:"full-width text-grey-14",style:ce({fontSize:t.isMobile?"12px":"14px",textAlign:t.isMobile?"start":"end",paddingTop:t.isMobile?"5px":""})}," Sin modificaciones",4))])]),p(Te,{modelValue:t.isEditingImage,"onUpdate:modelValue":e[6]||(e[6]=d=>t.isEditingImage=d)},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"550px"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[Ge(p(R,{icon:"close",color:"black",flat:"",round:"",class:"q-py-none"},null,512),[[et]])]),_:1}),p(te,{class:"q-pt-none",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[Fi]),_:1}),p(te,{class:"q-py-md"},{default:C(()=>[ie(" Selecciona una imagen para asignarla como imagen principal. ")]),_:1}),p(te,{class:"flex justify-around items-around",style:{"max-height":"450px"}},{default:C(()=>{var d;return[(w(!0),T(Me,null,He((d=t.inputInfo.images)==null?void 0:d.all,(u,c)=>Ge((w(),T("div",{key:c,style:{cursor:"pointer",position:"relative"},onMouseenter:m=>t.highlightedImageIndex=c,onMouseleave:e[3]||(e[3]=m=>t.highlightedImageIndex=-1),onClick:m=>t.setNewDefaultImge(u)},[p(Fe,{class:"q-pa-md q-ma-sm",src:t.imageServer+"/uploads/attachments/"+u,"spinner-color":"primary",style:{height:"120px",width:"140px"}},null,8,["src"]),t.highlightedImageIndex===c?(w(),T("div",Ri)):me("",!0)],40,Oi)),[[ti]])),128))]}),_:1}),p(de,{align:"right",class:"q-px-md q-pt-lg"},{default:C(()=>[p(Lt,{size:"0.75rem","label-color":"dark",outlined:"",rounded:"",dense:"",label:"Subir nueva imagen",accept:".jpg, image/*",modelValue:t.inputNewImage,"onUpdate:modelValue":[e[4]||(e[4]=d=>t.inputNewImage=d),e[5]||(e[5]=d=>t.uploadNewImage())]},{prepend:C(()=>[p(Se,{name:"cloud_upload",color:"dark",class:"q-px-xs"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var ji=Ie(Bi,[["render",Ui],["__scopeId","data-v-52ee74a6"]]),Vt=ni({name:"QVideo",props:{...di,src:{type:String,required:!0},title:String,fetchpriority:{type:String,default:"auto"},loading:{type:String,default:"eager"},referrerpolicy:{type:String,default:"strict-origin-when-cross-origin"}},setup(t){const e=ci(t),i=si(()=>"q-video"+(t.ratio!==void 0?" q-video--responsive":""));return()=>Et("div",{class:i.value,style:e.value},[Et("iframe",{src:t.src,title:t.title,fetchpriority:t.fetchpriority,loading:t.loading,referrerpolicy:t.referrerpolicy,frameborder:"0",allowfullscreen:!0})])}});const Hi=Be({name:"AssetActions",props:{rows:{type:Array},columns:{type:Array},loading:{type:Boolean}},components:{PrimaryButton:fi},setup(t){const e=x(i());function i(){const _=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),h=window.innerWidth<768;return _||h}window.addEventListener("resize",()=>{e.value=i()});const o=x(tt),n=Ke(),s=x(n.params.id),r=x(t.rows);r.value.forEach((_,h)=>{_.index=h+1}),ke(()=>t.rows,_=>{r.value=_,r.value.forEach((h,v)=>{h.index=v+1})});const a=x(!1),l=x({}),d=["Completado","Sin completar","En proceso","Otro"],u=x(!1),c=x(null),m=x({}),A=x(),$=x(0),P=x(!1);return{isMobile:e,router:n,attachmentsURL:o,idAsset:s,records:r,dialogNewAction:a,inputNewAction:l,actionOptions:d,dialogDeleteAction:u,currentAction:m,inputConfirmDelete:c,currentAttachment:$,dialogAttachmentsAction:A,dialogEditAction:P,pagination:x({rowsPerPage:0})}},methods:{defineStatusColor(t){if(t==="Completado")return"green";if(t==="Otro"||t==="En proceso")return"orange";if(t==="Sin completar")return"red"},addAction(){var e;const t=new FormData;Object.keys(this.inputNewAction).map(i=>{t.append(i,this.inputNewAction[i])}),(e=this.inputNewAction)!=null&&e.attachments&&this.inputNewAction.attachments.forEach((o,n)=>{t.append("attachments",o)}),Ce.patch(`./assets/update/create/action/${this.idAsset}`,t).then(i=>{i.data?(this.dialogNewAction=!1,this.inputNewAction={},this.$emit("update-info"),this.$q.notify({type:"positive",message:"Modificado correctamente.",timeout:2e3})):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(i=>{console.log(i),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})},openDeleteDialog(t){this.dialogDeleteAction=!0,this.currentAction=this.records.find(e=>e.id===t)},closeDeleteDialog(){this.dialogDeleteAction=!1,this.currentAction=null},openAttachmentDialog(t){this.dialogAttachmentsAction=!0,this.currentAction=this.records.find(e=>e.id===t)},closeAttachmentDialog(){this.dialogAttachmentsAction=!1,this.currentAction=null},deleteAction(t){Ce.patch(`./assets/update/delete/action/${this.idAsset}`,{idAction:t}).then(e=>{const i=e.data;console.log(i),i?(this.dialogDeleteAction=!1,this.inputConfirmDelete=null,this.currentAction=null,this.$emit("update-info"),this.$q.notify({type:"positive",message:"Borrado correctamente.",timeout:2e3})):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(e=>{console.log(e),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})},defineFileName(t){return t.replace(/\.[^.]+$/,"")},defineFileType(t){const e=t.split(".").pop().toLowerCase(),i=["jpg","jpeg","png","gif","bmp","tiff"],o=["mp4","avi","mkv","mov","wmv"];return i.includes(e)?"image":o.includes(e)?"video":"error"},openEditDialog(t){this.dialogEditAction=!0,this.currentAction=this.records.find(e=>e.id===t)},closeEditDialog(){this.dialogEditAction=!1,this.currentAction=null},saveAction(){Ce.patch(`./assets/update/update/action/${this.idAsset}`,this.currentAction).then(t=>{t.data?(this.dialogEditAction=!1,this.currentAction=null,this.$emit("update-info"),this.$q.notify({type:"positive",message:"Guardado correctamente.",timeout:2e3})):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(t=>{console.log(t),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})}}}),Gi={class:"row q-px-sm q-pt-sm q-pb-none"},Ki={class:"col-12 flex justify-between"},Xi=B("div",{class:"text-h6"},"Acciones",-1),Qi={class:"col-12 q-mt-md"},Wi=B("div",{class:"text-h5 text-weight-medium"},"Nueva Accion",-1),Ji={class:"q-mb-lg"},Zi={class:"text-h6"},Yi=B("div",{class:"text-center text-subtitle1 text-weight-regular"},"\xBFEstas seguro de borrarlo? ",-1),eo=B("div",{class:"text-subtitle2 text-weight-regular q-pt-sm"},"Ten en cuenta que una vez borrado no sera posible recuperarlo.",-1),to={class:"text-subtitle2 text-weight-regular q-pt-md"},io={class:"text-red text-weight-medium"},oo={class:"full-width q-pt-sm q-pb-md"},no={class:"text-h6"},so={class:"q-pb-lg text-subtitle2 text-weight-regular"},ao={class:"flex justify-center"},ro={class:"flex justify-center items-center"},lo={key:0},co={key:1},uo={key:2},fo=B("div",{class:"text-red full-width"},"Error al mostrar el contenido",-1),ho=[fo],go={class:"q-py-sm full-width text-center"},po={class:"full-width q-pt-sm flex justify-center items-center"},mo={class:"full-width text-center"},vo={class:"text-h5 text-weight-medium"},bo={class:"q-mb-lg"};function yo(t,e,i,o,n,s){const r=re("PrimaryButton"),a=re("q-title");return w(),T(Me,null,[B("div",Gi,[B("div",Ki,[Xi,t.isMobile?(w(),j(r,{key:0,flat:"",icon:"add",class:"q-mx-sm",onClick:e[0]||(e[0]=l=>t.dialogNewAction=!0)})):(w(),j(r,{key:1,label:"Agregar accion",icon:"add",class:"q-mx-sm",onClick:e[1]||(e[1]=l=>t.dialogNewAction=!0)}))]),B("div",Qi,[p(pi,{flat:"",bordered:"",rows:t.rows,columns:t.columns,loading:t.loading,"loading-label":"Cargando","row-key":"name","table-header-style":"font-weight: 100;",class:"q-pt-md","no-data-label":"No se encontraron datos","rows-per-page-label":"Cantidad de registros","rows-per-page-options":[5,10,20,30,0],style:{height:"64vh"}},{"body-cell-status":C(l=>[p(Qe,null,{default:C(()=>{var d,u;return[p(Se,{name:"circle",color:t.defineStatusColor((d=l.row)==null?void 0:d.status)},null,8,["color"]),ie(" \xA0 "+V((u=l.row)==null?void 0:u.status),1)]}),_:2},1024)]),"body-cell-attachments":C(l=>[l.row.attachments.length>0?(w(),j(Qe,{key:0},{default:C(()=>[p(R,{label:"Ver","icon-right":"navigate_next",color:"dark",outline:"",size:"0.75rem",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>t.openAttachmentDialog(l.row.id)},null,8,["onClick"])]),_:2},1024)):(w(),j(Qe,{key:1,class:"flex justify-center items-center"},{default:C(()=>[ie(" N/A ")]),_:1}))]),"body-cell-actions":C(l=>[p(Qe,{style:{width:"23%"}},{default:C(()=>[p(R,{label:"Editar","icon-right":"edit",color:"secondary",outline:"",size:"0.75rem",class:"q-mx-xs",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>t.openEditDialog(l.row.id)},null,8,["onClick"]),p(R,{label:"Borrar","icon-right":"delete",color:"red",outline:"",size:"0.75rem",class:"q-mx-xs",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>t.openDeleteDialog(l.row.id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","columns","loading"])])]),p(Te,{modelValue:t.dialogNewAction,"onUpdate:modelValue":e[8]||(e[8]=l=>t.dialogNewAction=l),persistent:""},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"700px","max-width":"80vw","max-height":"80vh"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[p(R,{icon:"close",color:"black",flat:"",round:"",onClick:e[2]||(e[2]=l=>t.dialogNewAction=!1),class:"q-py-none"})]),_:1}),p(te,{class:"q-pt-none q-pb-sm",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[Wi]),_:1}),p(te,null,{default:C(()=>[B("div",Ji,[p(a,{class:"text-subtitle2 text-weight-regular"},{default:C(()=>[ie("Completa los siguientes campos para agregar una nueva accion.")]),_:1})]),B("div",null,[p(Ve,{modelValue:t.inputNewAction.name,"onUpdate:modelValue":e[3]||(e[3]=l=>t.inputNewAction.name=l),clearable:"",dense:"",label:"Nombre",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","rules"]),p(Ve,{modelValue:t.inputNewAction.description,"onUpdate:modelValue":e[4]||(e[4]=l=>t.inputNewAction.description=l),clearable:"",dense:"",label:"Descripci\xF3n",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","rules"]),p(ht,{modelValue:t.inputNewAction.status,"onUpdate:modelValue":e[5]||(e[5]=l=>t.inputNewAction.status=l),options:t.actionOptions,clearable:"",dense:"",label:"Estado",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","options","rules"]),p(Lt,{modelValue:t.inputNewAction.attachments,"onUpdate:modelValue":e[6]||(e[6]=l=>t.inputNewAction.attachments=l),dense:"",label:"Imagenes o Videos","use-chips":"",multiple:"",class:"q-mb-md",accept:".jpg, image/*, .mp4, .mvk, video/*",hint:"opcional"},null,8,["modelValue"])])]),_:1}),p(de,{align:"right"},{default:C(()=>[p(R,{label:"Agregar",size:"0.85rem",color:"primary",dense:"",outline:"",padding:"sm lg",onClick:t.addAction,style:{"border-radius":"10px","text-transform":"capitalize"}},null,8,["onClick"]),p(R,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",outline:"",onClick:e[7]||(e[7]=l=>t.dialogNewAction=!1),padding:"sm lg",style:{"border-radius":"10px","text-transform":"capitalize"}})]),_:1})]),_:1})]),_:1},8,["modelValue"]),p(Te,{modelValue:t.dialogDeleteAction,"onUpdate:modelValue":e[11]||(e[11]=l=>t.dialogDeleteAction=l),persistent:""},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"500px","max-width":"80vw"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[Ge(p(R,{icon:"close",color:"black",flat:"",round:"",class:"q-py-none"},null,512),[[et]])]),_:1}),p(te,{class:"q-pt-none q-pb-md",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[B("div",Zi,"Borrar "+V(t.currentAction.name),1)]),_:1}),p(te,{class:"q-pt-md q-pb-sm flex justify-start"},{default:C(()=>[Yi,eo,B("div",to,[ie("Escribe "),B("span",io,"delete "+V(t.currentAction.name),1),ie(" a continuaci\xF3n para confirmar.")]),B("div",oo,[p(Ve,{modelValue:t.inputConfirmDelete,"onUpdate:modelValue":e[9]||(e[9]=l=>t.inputConfirmDelete=l),outlined:"",dense:"",class:"full-width"},null,8,["modelValue"])])]),_:1}),p(de,{align:"right"},{default:C(()=>[p(R,{label:"Confirmar",size:"0.85rem",color:"red",dense:"",padding:"sm lg",outline:"",style:{"border-radius":"10px","text-transform":"capitalize"},disabled:t.inputConfirmDelete!==`delete ${t.currentAction.name}`,onClick:e[10]||(e[10]=l=>t.deleteAction(t.currentAction.id))},null,8,["disabled"]),Ge(p(R,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",padding:"sm lg",style:{"border-radius":"10px","text-transform":"capitalize"}},null,512),[[et]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),p(Te,{modelValue:t.dialogAttachmentsAction,"onUpdate:modelValue":e[15]||(e[15]=l=>t.dialogAttachmentsAction=l),persistent:""},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"600px","max-width":"80vw"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[p(R,{icon:"close",color:"black",flat:"",round:"",onClick:e[12]||(e[12]=l=>t.closeAttachmentDialog()),class:"q-py-none"})]),_:1}),p(te,{class:"q-pt-none q-pb-md",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[B("div",no,V(t.currentAction.name),1)]),_:1}),p(te,{class:"q-pt-lg q-pb-sm"},{default:C(()=>[B("div",so,"Images o videos adjuntados en la accion "+V(t.currentAction.name)+".",1),B("div",ao,[B("div",ro,[t.defineFileType(t.currentAction.attachments[t.currentAttachment])==="image"?(w(),T("div",lo,[p(Fe,{src:t.attachmentsURL+"/uploads/attachments/"+t.currentAction.attachments[t.currentAttachment],"spinner-color":"primary",style:{width:"536px","max-width":"70vw"}},null,8,["src"])])):t.defineFileType(t.currentAction.attachments[t.currentAttachment])==="video"?(w(),T("div",co,[p(Vt,{src:t.attachmentsURL+"/uploads/attachments/"+t.currentAction.attachments[t.currentAttachment],style:{width:"536px","max-width":"70vw"}},null,8,["src"])])):(w(),T("div",uo,ho)),B("div",go,V(t.defineFileName(t.currentAction.attachments[t.currentAttachment])),1)]),B("div",po,[p(R,{flat:"",round:"",size:"0.95rem",icon:"navigate_before",onClick:e[13]||(e[13]=l=>t.currentAttachment=Number(t.currentAttachment)-1),disabled:!t.currentAction.attachments[t.currentAttachment-1]},null,8,["disabled"]),p(R,{flat:"",round:"",size:"0.95rem",icon:"navigate_next",onClick:e[14]||(e[14]=l=>t.currentAttachment=Number(t.currentAttachment)+1),disabled:!t.currentAction.attachments[t.currentAttachment+1]},null,8,["disabled"])]),B("div",mo,V(t.currentAttachment+1)+" / "+V(t.currentAction.attachments.length),1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),p(Te,{modelValue:t.dialogEditAction,"onUpdate:modelValue":e[19]||(e[19]=l=>t.dialogEditAction=l),persistent:""},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"700px","max-width":"80vw","max-height":"80vh"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[p(R,{icon:"close",color:"black",flat:"",round:"",onClick:t.closeEditDialog,class:"q-py-none"},null,8,["onClick"])]),_:1}),p(te,{class:"q-pt-none q-pb-sm",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[B("div",vo,"Editar "+V(t.currentAction.name),1)]),_:1}),p(te,null,{default:C(()=>[B("div",bo,[p(a,{class:"text-subtitle2 text-weight-regular"},{default:C(()=>[ie("Modifica los el valor de los campos que necesites actualizar.")]),_:1})]),B("div",null,[p(Ve,{modelValue:t.currentAction.name,"onUpdate:modelValue":e[16]||(e[16]=l=>t.currentAction.name=l),clearable:"",dense:"",label:"Nombre",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","rules"]),p(Ve,{modelValue:t.currentAction.description,"onUpdate:modelValue":e[17]||(e[17]=l=>t.currentAction.description=l),clearable:"",dense:"",label:"Descripci\xF3n",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","rules"]),p(ht,{modelValue:t.currentAction.status,"onUpdate:modelValue":e[18]||(e[18]=l=>t.currentAction.status=l),options:t.actionOptions,clearable:"",dense:"",label:"Estado",class:"q-mb-md",hint:"requerido",rules:[l=>!!l||"requerido"]},null,8,["modelValue","options","rules"])])]),_:1}),p(de,{align:"right"},{default:C(()=>[p(R,{label:"Guardar",size:"0.85rem",color:"secondary",dense:"",outline:"",padding:"sm lg",onClick:t.saveAction,style:{"border-radius":"10px","text-transform":"capitalize"}},null,8,["onClick"]),p(R,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",outline:"",onClick:t.closeEditDialog,padding:"sm lg",style:{"border-radius":"10px","text-transform":"capitalize"}},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var wo=Ie(Hi,[["render",yo]]);const Ao=Be({name:"AssetAttachments",props:{asset:{type:Object}},components:{},setup(t){var u;const e=x(i());function i(){const c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),m=window.innerWidth<768;return c||m}window.addEventListener("resize",()=>{e.value=i()});const o=x(tt),n=Ke(),s=x(n.params.id),r=x(l(t.asset.images.default_image)),a=x([]);if(t.asset){const c=t.asset;(u=c.images)!=null&&u.all&&c.images.all.map(m=>{a.value.push({label:l(m),type:d(m),url:`${o.value}/uploads/attachments/${m}`})}),c.actions&&c.actions.map(m=>{m.attachments.map(A=>{a.value.push({label:`Accion ${m.name}: ${l(A)}`,type:d(A),url:`${o.value}/uploads/attachments/${A}`})})})}function l(c){return c.replace(/\.[^.]+$/,"")}function d(c){const m=c.split(".").pop().toLowerCase(),A=["jpg","jpeg","png","gif","bmp","tiff"],$=["mp4","avi","mkv","mov","wmv"];return A.includes(m)?"image":$.includes(m)?"video":"error"}return{isMobile:e,router:n,attachmentsURL:o,idAsset:s,allAttachments:a,defaultImage:r}},methods:{downloadAttachment(t){fetch(url).then(e=>e.blob()).then(e=>{let i=URL.createObjectURL(e),o=document.createElement("a");o.href=i,o.download="imagen.jpg",o.click()}).catch(e=>console.error(e))}}}),Co={class:"row q-px-sm q-pt-sm q-pb-none"},ko=B("div",{class:"col-12 flex justify-between"},[B("div",{class:"text-h6"},"Archivos adjuntados")],-1),Io={class:"col-12 q-mt-md"},Eo={class:"row flex justify-between"},Do={key:0},$o={key:1},Po={key:2},So=B("div",{class:"text-red full-width"},"Error al mostrar el contenido",-1),Bo=[So],xo={class:"q-pt-sm",style:{"font-size":"0.85rem"}},Mo={key:0,class:"text-grey-14 q-pt-xs",style:{"font-size":"0.75rem"}};function To(t,e,i,o,n,s){return w(),T("div",Co,[ko,B("div",Io,[B("div",Eo,[(w(!0),T(Me,null,He(t.allAttachments,(r,a)=>(w(),T("div",{class:"col-lg-3 col-md-4 col-sm-6 col-12 q-pa-md",key:a+1},[p($e,{class:"my-card text-center"},{default:C(()=>[p(de,{align:"right",class:"q-pt-sm q-pb-none"},{default:C(()=>[p(R,{icon:"download",color:"black",flat:"",round:"",class:"q-py-none",size:"0.75rem",disabled:!r.url,onClick:l=>t.downloadAttachment(r)},null,8,["disabled","onClick"])]),_:2},1024),p(te,{class:"q-py-none",style:{height:"200px",display:"grid","align-items":"center"}},{default:C(()=>[r.type==="image"?(w(),T("div",Do,[r.url?(w(),j(Fe,{key:0,src:r.url,style:{width:"90%",height:"200px"},"spinner-color":"primary",onError:()=>r.url=null},null,8,["src","onError"])):(w(),j(Se,{key:1,name:"image",size:"180px",class:"q-pa-md q-mx-sm",style:{"max-width":"260"}}))])):r.type==="video"?(w(),T("div",$o,[r.url?(w(),j(Vt,{key:0,src:r.url,style:{width:"90%"},"spinner-color":"primary"},null,8,["src"])):(w(),j(Se,{key:1,name:"videocam",size:"180px",class:"q-pa-md q-mx-sm",style:{"max-width":"260"}}))])):(w(),T("div",Po,Bo))]),_:2},1024),p(te,{style:{height:"85px",display:"grid","align-items":"center"}},{default:C(()=>[B("div",xo,V(r.label),1),t.defaultImage===r.label?(w(),T("div",Mo," Imagen predeterminada ")):me("",!0)]),_:2},1024)]),_:2},1024)]))),128))])])])}var qo=Ie(Ao,[["render",To]]);function lt(t){return t===""?t:t==="true"||t=="1"}function _o(t,e){return new Promise((i,o)=>{var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var s=new FileReader;s.onloadend=function(){i(s.result)},s.readAsArrayBuffer(n.response)},n.open("GET",t),n.send()})}function pe(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function Dt(t,e){for(var i="",o=0,n=-1,s=0,r,a=0;a<=t.length;++a){if(a<t.length)r=t.charCodeAt(a);else{if(r===47)break;r=47}if(r===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){l===-1?(i="",o=0):(i=i.slice(0,l),o=i.length-1-i.lastIndexOf("/")),n=a,s=0;continue}}else if(i.length===2||i.length===1){i="",o=0,n=a,s=0;continue}}e&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+t.slice(n+1,a):i=t.slice(n+1,a),o=a-n-1;n=a,s=0}else r===46&&s!==-1?++s:s=-1}return i}function Lo(t,e){var i=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return i?i===e.root?i+o:i+t+o:o}var Le={resolve:function(){for(var e="",i=!1,o,n=arguments.length-1;n>=-1&&!i;n--){var s;n>=0?s=arguments[n]:(o===void 0&&(o=process.cwd()),s=o),pe(s),s.length!==0&&(e=s+"/"+e,i=s.charCodeAt(0)===47)}return e=Dt(e,!i),i?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(pe(e),e.length===0)return".";var i=e.charCodeAt(0)===47,o=e.charCodeAt(e.length-1)===47;return e=Dt(e,!i),e.length===0&&!i&&(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return pe(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,i=0;i<arguments.length;++i){var o=arguments[i];pe(o),o.length>0&&(e===void 0?e=o:e+="/"+o)}return e===void 0?".":Le.normalize(e)},relative:function(e,i){if(pe(e),pe(i),e===i||(e=Le.resolve(e),i=Le.resolve(i),e===i))return"";for(var o=1;o<e.length&&e.charCodeAt(o)===47;++o);for(var n=e.length,s=n-o,r=1;r<i.length&&i.charCodeAt(r)===47;++r);for(var a=i.length,l=a-r,d=s<l?s:l,u=-1,c=0;c<=d;++c){if(c===d){if(l>d){if(i.charCodeAt(r+c)===47)return i.slice(r+c+1);if(c===0)return i.slice(r+c)}else s>d&&(e.charCodeAt(o+c)===47?u=c:c===0&&(u=0));break}var m=e.charCodeAt(o+c),A=i.charCodeAt(r+c);if(m!==A)break;m===47&&(u=c)}var $="";for(c=o+u+1;c<=n;++c)(c===n||e.charCodeAt(c)===47)&&($.length===0?$+="..":$+="/..");return $.length>0?$+i.slice(r+u):(r+=u,i.charCodeAt(r)===47&&++r,i.slice(r))},_makeLong:function(e){return e},dirname:function(e){if(pe(e),e.length===0)return".";for(var i=e.charCodeAt(0),o=i===47,n=-1,s=!0,r=e.length-1;r>=1;--r)if(i=e.charCodeAt(r),i===47){if(!s){n=r;break}}else s=!1;return n===-1?o?"/":".":o&&n===1?"//":e.slice(0,n)},basename:function(e,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');pe(e);var o=0,n=-1,s=!0,r;if(i!==void 0&&i.length>0&&i.length<=e.length){if(i.length===e.length&&i===e)return"";var a=i.length-1,l=-1;for(r=e.length-1;r>=0;--r){var d=e.charCodeAt(r);if(d===47){if(!s){o=r+1;break}}else l===-1&&(s=!1,l=r+1),a>=0&&(d===i.charCodeAt(a)?--a===-1&&(n=r):(a=-1,n=l))}return o===n?n=l:n===-1&&(n=e.length),e.slice(o,n)}else{for(r=e.length-1;r>=0;--r)if(e.charCodeAt(r)===47){if(!s){o=r+1;break}}else n===-1&&(s=!1,n=r+1);return n===-1?"":e.slice(o,n)}},extname:function(e){pe(e);for(var i=-1,o=0,n=-1,s=!0,r=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!s){o=a+1;break}continue}n===-1&&(s=!1,n=a+1),l===46?i===-1?i=a:r!==1&&(r=1):i!==-1&&(r=-1)}return i===-1||n===-1||r===0||r===1&&i===n-1&&i===o+1?"":e.slice(i,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Lo("/",e)},parse:function(e){pe(e);var i={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return i;var o=e.charCodeAt(0),n=o===47,s;n?(i.root="/",s=1):s=0;for(var r=-1,a=0,l=-1,d=!0,u=e.length-1,c=0;u>=s;--u){if(o=e.charCodeAt(u),o===47){if(!d){a=u+1;break}continue}l===-1&&(d=!1,l=u+1),o===46?r===-1?r=u:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||l===-1||c===0||c===1&&r===l-1&&r===a+1?l!==-1&&(a===0&&n?i.base=i.name=e.slice(1,l):i.base=i.name=e.slice(a,l)):(a===0&&n?(i.name=e.slice(1,r),i.base=e.slice(1,l)):(i.name=e.slice(a,r),i.base=e.slice(a,l)),i.ext=e.slice(r,l)),a>0?i.dir=e.slice(0,a-1):n&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};Le.posix=Le;const No=Le.extname,Ft=Le.basename;class zo{constructor(){let e=(()=>typeof global=="undefined")(),i="image/png",o="image/jpeg",n="image/jpeg",s="image/webp",r="application/pdf",a="image/svg+xml";Object.assign(this,{toMime:this.toMime.bind(this),fromMime:this.fromMime.bind(this),expected:e?'"png", "jpg", or "webp"':'"png", "jpg", "pdf", or "svg"',formats:e?{png:i,jpg:o,jpeg:n,webp:s}:{png:i,jpg:o,jpeg:n,pdf:r,svg:a},mimes:e?{[i]:"png",[o]:"jpg",[s]:"webp"}:{[i]:"png",[o]:"jpg",[r]:"pdf",[a]:"svg"}})}toMime(e){return this.formats[(e||"").replace(/^\./,"").toLowerCase()]}fromMime(e){return this.mimes[e]}}function Vo(t,{filename:e="",extension:i="",format:P,page:n,quality:s,matte:r,density:a,outline:l,archive:A}={}){var{fromMime:u,toMime:c,expected:m}=new zo,A=A||"canvas",$=P||i.replace(/@\d+x$/i,"")||No(e),P=u(c($)||$),_=c(P),h=t.length;if(!$)throw new Error("Cannot determine image format (use a filename extension or 'format' argument)");if(!P)throw new Error(`Unsupported file format "${$}" (expected ${m})`);if(!h)throw new RangeError("Canvas has no associated contexts (try calling getContext or newPage first)");let v,I,f=e.replace(/{(\d*)}/g,(y,E)=>(I=!0,E=parseInt(E,10),v=isFinite(E)?E:isFinite(v)?v:-1,"{}")),b=n>0?n-1:n<0?h+n:void 0;if(isFinite(b)&&b<0||b>=h)throw new RangeError(h==1?`Canvas only has a \u2018page 1\u2019 (${b} is out of bounds)`:`Canvas has pages 1\u2013${h} (${b} is out of bounds)`);if(t=isFinite(b)?[t[b]]:I||P=="pdf"?t:t.slice(-1),s===void 0)s=.92;else if(typeof s!="number"||!isFinite(s)||s<0||s>1)throw new TypeError("The quality option must be an number in the 0.0\u20131.0 range");if(a===void 0){let y=(i||Ft(e,$)).match(/@(\d+)x$/i);a=y?parseInt(y[1],10):1}else if(typeof a!="number"||!Number.isInteger(a)||a<1)throw new TypeError("The density option must be a non-negative integer");return l===void 0?l=!0:P=="svg"&&(l=!!l),{filename:e,pattern:f,format:P,mime:_,pages:t,padding:v,quality:s,matte:r,density:a,outline:l,archive:A}}class it{static for(e){return new it().append(e).get()}constructor(){this.crc=-1}get(){return~this.crc}append(e){for(var i=this.crc|0,o=this.table,n=0,s=e.length|0;n<s;n++)i=i>>>8^o[(i^e[n])&255];return this.crc=i,this}}it.prototype.table=(()=>{var t,e,i,o=[];for(t=0;t<256;t++){for(i=t,e=0;e<8;e++)i=i&1?i>>>1^3988292384:i>>>1;o[t]=i}return o})();function dt(t){let e=new Uint8Array(t),i=new DataView(e.buffer),o={array:e,view:i,size:t,set8(n,s){return i.setUint8(n,s),o},set16(n,s){return i.setUint16(n,s,!0),o},set32(n,s){return i.setUint32(n,s,!0),o},bytes(n,s){return e.set(s,n),o}};return o}class ot{constructor(e){let i=new Date;Object.assign(this,{directory:e,offset:0,files:[],time:(i.getHours()<<6|i.getMinutes())<<5|i.getSeconds()/2,date:(i.getFullYear()-1980<<4|i.getMonth()+1)<<5|i.getDate()}),this.add(e)}async add(e,i){let o=!i,n=ot.encoder.encode(`${this.directory}/${o?"":e}`),s=new Uint8Array(o?0:await i.arrayBuffer()),r=30+n.length,a=r+s.length,l=16,{offset:d}=this,u=dt(26).set32(0,134742036).set16(6,this.time).set16(8,this.date).set32(10,it.for(s)).set32(14,s.length).set32(18,s.length).set16(22,n.length);d+=r;let c=dt(r+s.length+l).set32(0,67324752).bytes(4,u.array).bytes(30,n).bytes(r,s);d+=s.length,c.set32(a,134695760).bytes(a+4,u.array.slice(10,22)),d+=l,this.files.push({offset:d,folder:o,name:n,header:u,payload:c}),this.offset=d}toBuffer(){let e=this.files.reduce((c,{name:m})=>46+m.length+c,0),i=dt(e+22),o=0;for(var{offset:n,name:s,header:r,folder:a}of this.files)i.set32(o,33639248).set16(o+4,20).bytes(o+6,r.array).set8(o+38,a?16:0).set32(o+42,n).bytes(o+46,s),o+=46+s.length;i.set32(o,101010256).set16(o+8,this.files.length).set16(o+10,this.files.length).set32(o+12,e).set32(o+16,this.offset);let l=new Uint8Array(this.offset+i.size),d=0;for(var{payload:u}of this.files)l.set(u.array,d),d+=u.size;return l.set(i.array,d),l}get blob(){return new Blob([this.toBuffer()],{type:"application/zip"})}}ot.encoder=new TextEncoder;const mt=(t,e,i,o)=>{if(o){let{width:n,height:s}=t,r=Object.assign(document.createElement("canvas"),{width:n,height:s}),a=r.getContext("2d");a.fillStyle=o,a.fillRect(0,0,n,s),a.drawImage(t,0,0),t=r}return new Promise((n,s)=>t.toBlob(n,e,i))},Fo=(...t)=>mt(...t).then(e=>e.arrayBuffer()),Oo=async(t,e,i,o,n)=>{Ot(n,await mt(t,e,i,o))},Ro=async(t,e,i,o,n,s,r)=>{let a=u=>s.replace("{}",String(u+1).padStart(r,"0")),l=Ft(n,".zip")||"archive",d=new ot(l);await Promise.all(t.map(async(u,c)=>{let m=a(c);await d.add(m,await mt(u,e,i,o))})),Ot(`${l}.zip`,d.blob)},Ot=(t,e)=>{const i=window.URL.createObjectURL(e),o=document.createElement("a");o.style.display="none",o.href=i,o.setAttribute("download",t),typeof o.download=="undefined"&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>window.URL.revokeObjectURL(i),100)},Uo=(t,e,i)=>t.map(o=>{if(e==1&&!i)return o.canvas;let n=document.createElement("canvas"),s=n.getContext("2d"),r=o.canvas?o.canvas:o;return n.width=r.width*e,n.height=r.height*e,i&&(s.fillStyle=i,s.fillRect(0,0,n.width,n.height)),s.scale(e,e),s.drawImage(r,0,0),n}),jo={asBuffer:Fo,asDownload:Oo,asZipDownload:Ro,atScale:Uo,options:Vo},{asBuffer:ct,asDownload:Ho,asZipDownload:Go,atScale:ut,options:ft}=jo,$t=Symbol.for("toDataURL"),Ko=t=>new Promise((e,i)=>Object.assign(new Rt,{crossOrigin:"Anonymous",onload:e,onerror:i,src:t}));class Xo{constructor(e,i){let o=document.createElement("canvas"),n=[];Object.defineProperty(o,"async",{value:!0,writable:!1,enumerable:!0});for(var[s,r]of Object.entries({png:()=>ct(o,"image/png"),jpg:()=>ct(o,"image/jpeg"),pages:()=>n.concat(o).map(a=>a.getContext("2d"))}))Object.defineProperty(o,s,{get:r});return Object.assign(o,{width:e,height:i,newPage(...a){var{width:d,height:u}=o,l=Object.assign(document.createElement("canvas"),{width:d,height:u});l.getContext("2d").drawImage(o,0,0),n.push(l);var[d,u]=a.length?a:[d,u];return Object.assign(o,{width:d,height:u}).getContext("2d")},saveAs(a,l){l=typeof l=="number"?{quality:l}:l;let d=ft(this.pages,{filename:a,...l}),{pattern:u,padding:c,mime:m,quality:A,matte:$,density:P,archive:_}=d,h=ut(d.pages,P);return c==null?Ho(h[0],m,A,$,a):Go(h,m,A,$,_,u,c)},toBuffer(a="png",l={}){l=typeof l=="number"?{quality:l}:l;let d=ft(this.pages,{extension:a,...l}),{mime:u,quality:c,matte:m,pages:A,density:$}=d,P=ut(A,$,m)[0];return ct(P,u,c,m)},[$t]:o.toDataURL.bind(o),toDataURL(a="png",l={}){l=typeof l=="number"?{quality:l}:l;let d=ft(this.pages,{extension:a,...l}),{mime:u,quality:c,matte:m,pages:A,density:$}=d,P=ut(A,$,m)[0],_=P[P===o?$t:"toDataURL"](u,c);return Promise.resolve(_)}})}}const{CanvasRenderingContext2D:Qo,CanvasGradient:Wo,CanvasPattern:Jo,Image:Rt,ImageData:Zo,Path2D:Yo,DOMMatrix:en,DOMRect:tn,DOMPoint:on}=window,nn={Canvas:Xo,loadImage:Ko,CanvasRenderingContext2D:Qo,CanvasGradient:Wo,CanvasPattern:Jo,Image:Rt,ImageData:Zo,Path2D:Yo,DOMMatrix:en,DOMRect:tn,DOMPoint:on},je=(t,e,i={},o=i)=>{if(Array.isArray(e))e.forEach(n=>je(t,n,i,o));else if(typeof e=="function")e(t,i,o,je);else{const n=Object.keys(e)[0];Array.isArray(e[n])?(o[n]={},je(t,e[n],i,o[n])):o[n]=e[n](t,i,o,je)}return i},Ne=(t,e)=>(i,o,n,s)=>{e(i,o,n)&&s(i,t,o,n)},sn=(t,e)=>(i,o,n,s)=>{const r=[];let a=i.pos;for(;e(i,o,n);){const l={};if(s(i,t,o,l),i.pos===a)break;a=i.pos,r.push(l)}return r},an=t=>({data:t,pos:0}),ue=()=>t=>t.data[t.pos++],Ut=(t=0)=>e=>e.data[e.pos+t],be=t=>e=>e.data.subarray(e.pos,e.pos+=t),nt=t=>e=>e.data.subarray(e.pos,e.pos+t),gt=t=>e=>Array.from(be(t)(e)).map(i=>String.fromCharCode(i)).join(""),qe=t=>e=>{const i=be(2)(e);return t?(i[1]<<8)+i[0]:(i[0]<<8)+i[1]},jt=(t,e)=>(i,o,n)=>{const s=typeof e=="function"?e(i,o,n):e,r=be(t),a=new Array(s);for(var l=0;l<s;l++)a[l]=r(i);return a},rn=(t,e,i)=>{for(var o=0,n=0;n<i;n++)o+=t[e+n]&&2**(i-n-1);return o},vt=t=>e=>{const i=ue()(e),o=new Array(8);for(var n=0;n<8;n++)o[7-n]=!!(i&1<<n);return Object.keys(t).reduce((s,r)=>{const a=t[r];return a.length?s[r]=rn(o,a.index,a.length):s[r]=o[a.index],s},{})};var st={blocks:t=>{const i=[],o=t.data.length;for(var n=0,s=ue()(t);s!==0&&s;s=ue()(t)){if(t.pos+s>=o){const d=o-t.pos;i.push(be(d)(t)),n+=d;break}i.push(be(s)(t)),n+=s}const r=new Uint8Array(n);for(var a=0,l=0;l<i.length;l++)r.set(i[l],a),a+=i[l].length;return r}};const ln=Ne({gce:[{codes:be(2)},{byteSize:ue()},{extras:vt({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:qe(!0)},{transparentColorIndex:ue()},{terminator:ue()}]},t=>{var e=nt(2)(t);return e[0]===33&&e[1]===249}),dn=Ne({image:[{code:ue()},{descriptor:[{left:qe(!0)},{top:qe(!0)},{width:qe(!0)},{height:qe(!0)},{lct:vt({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},Ne({lct:jt(3,(t,e,i)=>Math.pow(2,i.descriptor.lct.size+1))},(t,e,i)=>i.descriptor.lct.exists),{data:[{minCodeSize:ue()},st]}]},t=>Ut()(t)===44),cn=Ne({text:[{codes:be(2)},{blockSize:ue()},{preData:(t,e,i)=>be(i.text.blockSize)(t)},st]},t=>{var e=nt(2)(t);return e[0]===33&&e[1]===1}),un=Ne({application:[{codes:be(2)},{blockSize:ue()},{id:(t,e,i)=>gt(i.blockSize)(t)},st]},t=>{var e=nt(2)(t);return e[0]===33&&e[1]===255}),fn=Ne({comment:[{codes:be(2)},st]},t=>{var e=nt(2)(t);return e[0]===33&&e[1]===254}),hn=[{header:[{signature:gt(3)},{version:gt(3)}]},{lsd:[{width:qe(!0)},{height:qe(!0)},{gct:vt({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:ue()},{pixelAspectRatio:ue()}]},Ne({gct:jt(3,(t,e)=>Math.pow(2,e.lsd.gct.size+1))},(t,e)=>e.lsd.gct.exists),{frames:sn([ln,un,fn,dn,cn],t=>{var e=Ut()(t);return e===33||e===44})}],gn=(t,e)=>{const i=new Array(t.length),o=t.length/e,n=function(u,c){const m=t.slice(c*e,(c+1)*e);i.splice.apply(i,[u*e,e].concat(m))},s=[0,4,2,1],r=[8,8,4,2];for(var a=0,l=0;l<4;l++)for(var d=s[l];d<o;d+=r[l])n(d,a),a++;return i},pn=(t,e,i)=>{const s=i;var r,a,l,d,u,c,m,b,A,$,f,P,y,E,L,S;const _=new Array(i),h=new Array(4096),v=new Array(4096),I=new Array(4096+1);for(P=t,a=1<<P,u=a+1,r=a+2,m=-1,d=P+1,l=(1<<d)-1,A=0;A<a;A++)h[A]=0,v[A]=A;var f,b,y,E,S,L;for(f=b=y=E=S=L=0,$=0;$<s;){if(E===0){if(b<d){f+=e[L]<<b,b+=8,L++;continue}if(A=f&l,f>>=d,b-=d,A>r||A==u)break;if(A==a){d=P+1,l=(1<<d)-1,r=a+2,m=-1;continue}if(m==-1){I[E++]=v[A],m=A,y=A;continue}for(c=A,A==r&&(I[E++]=y,A=m);A>a;)I[E++]=v[A],A=h[A];y=v[A]&255,I[E++]=y,r<4096&&(h[r]=m,v[r]=y,r++,(r&l)===0&&r<4096&&(d++,l+=r)),m=c}E--,_[S++]=I[E],$++}for($=S;$<s;$++)_[$]=0;return _},mn=t=>{const e=new Uint8Array(t);return je(an(e),hn)},vn=t=>{const e=t.pixels.length,i=new Uint8ClampedArray(e*4);for(var o=0;o<e;o++){const n=o*4,s=t.pixels[o],r=t.colorTable[s];i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=s!==t.transparentIndex?255:0}return i},bn=(t,e,i)=>{if(!t.image){console.warn("gif frame does not have associated image.");return}const{image:o}=t,n=o.descriptor.width*o.descriptor.height;var s=pn(o.data.minCodeSize,o.data.blocks,n);o.descriptor.lct.interlaced&&(s=gn(s,o.descriptor.width));const r={pixels:s,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return o.descriptor.lct&&o.descriptor.lct.exists?r.colorTable=o.lct:r.colorTable=e,t.gce&&(r.delay=(t.gce.delay||10)*10,r.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(r.transparentIndex=t.gce.transparentColorIndex)),i&&(r.patch=vn(r)),r},yn=(t,e)=>t.frames.filter(i=>i.image).map(i=>bn(i,t.gct,e));function wn(t,e,i){const o=Ht(e),n=t-1;let s=0;switch(i){case ne.L:s=ve[n][0];break;case ne.M:s=ve[n][1];break;case ne.Q:s=ve[n][2];break;case ne.H:s=ve[n][3];break}return o<=s}function An(t,e){for(var i=1,o=Ht(t),n=0,s=ve.length;n<s;n++){var r=0;switch(e){case ne.L:r=ve[n][0];break;case ne.M:r=ve[n][1];break;case ne.Q:r=ve[n][2];break;case ne.H:r=ve[n][3];break}if(o<=r)break;i++}if(i>ve.length)throw new Error("Too long data");return i}function Ht(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=Number(t)?3:0)}class Cn{constructor(e){this.mode=ae.MODE_8BIT_BYTE,this.parsedData=[],this.data=e;const i=[];for(let o=0,n=this.data.length;o<n;o++){const s=[],r=this.data.charCodeAt(o);r>65536?(s[0]=240|(r&1835008)>>>18,s[1]=128|(r&258048)>>>12,s[2]=128|(r&4032)>>>6,s[3]=128|r&63):r>2048?(s[0]=224|(r&61440)>>>12,s[1]=128|(r&4032)>>>6,s[2]=128|r&63):r>128?(s[0]=192|(r&1984)>>>6,s[1]=128|r&63):s[0]=r,i.push(s)}this.parsedData=Array.prototype.concat.apply([],i),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(e){for(let i=0,o=this.parsedData.length;i<o;i++)e.put(this.parsedData[i],8)}}class Pe{constructor(e=-1,i=ne.L){this.moduleCount=0,this.dataList=[],this.typeNumber=e,this.errorCorrectLevel=i,this.moduleCount=0,this.dataList=[]}addData(e){if(this.typeNumber<=0)this.typeNumber=An(e,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error(`Invalid QR version: ${this.typeNumber}`);if(!wn(this.typeNumber,e,this.errorCorrectLevel))throw new Error(`Data is too long for QR version: ${this.typeNumber}`)}const i=new Cn(e);this.dataList.push(i),this.dataCache=void 0}isDark(e,i){if(e<0||this.moduleCount<=e||i<0||this.moduleCount<=i)throw new Error(`${e},${i}`);return this.modules[e][i]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(e,i){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(let o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(let n=0;n<this.moduleCount;n++)this.modules[o][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,i),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=Pe.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)}setupPositionProbePattern(e,i){for(let o=-1;o<=7;o++)if(!(e+o<=-1||this.moduleCount<=e+o))for(let n=-1;n<=7;n++)i+n<=-1||this.moduleCount<=i+n||(0<=o&&o<=6&&(n==0||n==6)||0<=n&&n<=6&&(o==0||o==6)||2<=o&&o<=4&&2<=n&&n<=4?this.modules[e+o][i+n]=!0:this.modules[e+o][i+n]=!1)}getBestMaskPattern(){if(Number.isInteger(this.maskPattern)&&Object.values(we).includes(this.maskPattern))return this.maskPattern;let e=0,i=0;for(let o=0;o<8;o++){this.makeImpl(!0,o);const n=O.getLostPoint(this);(o==0||e>n)&&(e=n,i=o)}return i}setupTimingPattern(){for(let e=8;e<this.moduleCount-8;e++)this.modules[e][6]==null&&(this.modules[e][6]=e%2==0);for(let e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)}setupPositionAdjustPattern(){const e=O.getPatternPosition(this.typeNumber);for(let i=0;i<e.length;i++)for(let o=0;o<e.length;o++){const n=e[i],s=e[o];if(this.modules[n][s]==null)for(let r=-2;r<=2;r++)for(let a=-2;a<=2;a++)r==-2||r==2||a==-2||a==2||r==0&&a==0?this.modules[n+r][s+a]=!0:this.modules[n+r][s+a]=!1}}setupTypeNumber(e){const i=O.getBCHTypeNumber(this.typeNumber);for(var o=0;o<18;o++){var n=!e&&(i>>o&1)==1;this.modules[Math.floor(o/3)][o%3+this.moduleCount-8-3]=n}for(var o=0;o<18;o++){var n=!e&&(i>>o&1)==1;this.modules[o%3+this.moduleCount-8-3][Math.floor(o/3)]=n}}setupTypeInfo(e,i){const o=this.errorCorrectLevel<<3|i,n=O.getBCHTypeInfo(o);for(var s=0;s<15;s++){var r=!e&&(n>>s&1)==1;s<6?this.modules[s][8]=r:s<8?this.modules[s+1][8]=r:this.modules[this.moduleCount-15+s][8]=r}for(var s=0;s<15;s++){var r=!e&&(n>>s&1)==1;s<8?this.modules[8][this.moduleCount-s-1]=r:s<9?this.modules[8][15-s-1+1]=r:this.modules[8][15-s-1]=r}this.modules[this.moduleCount-8][8]=!e}mapData(e,i){let o=-1,n=this.moduleCount-1,s=7,r=0;for(let a=this.moduleCount-1;a>0;a-=2)for(a==6&&a--;;){for(let l=0;l<2;l++)if(this.modules[n][a-l]==null){let d=!1;r<e.length&&(d=(e[r]>>>s&1)==1),O.getMask(i,n,a-l)&&(d=!d),this.modules[n][a-l]=d,s--,s==-1&&(r++,s=7)}if(n+=o,n<0||this.moduleCount<=n){n-=o,o=-o;break}}}static createData(e,i,o){const n=Ae.getRSBlocks(e,i),s=new kn;for(var r=0;r<o.length;r++){const l=o[r];s.put(l.mode,4),s.put(l.getLength(),O.getLengthInBits(l.mode,e)),l.write(s)}let a=0;for(var r=0;r<n.length;r++)a+=n[r].dataCount;if(s.getLengthInBits()>a*8)throw new Error(`code length overflow. (${s.getLengthInBits()}>${a*8})`);for(s.getLengthInBits()+4<=a*8&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=a*8||(s.put(Pe.PAD0,8),s.getLengthInBits()>=a*8));)s.put(Pe.PAD1,8);return Pe.createBytes(s,n)}static createBytes(e,i){let o=0,n=0,s=0;const r=new Array(i.length),a=new Array(i.length);for(var l=0;l<i.length;l++){const A=i[l].dataCount,$=i[l].totalCount-A;n=Math.max(n,A),s=Math.max(s,$),r[l]=new Array(A);for(var d=0;d<r[l].length;d++)r[l][d]=255&e.buffer[d+o];o+=A;const P=O.getErrorCorrectPolynomial($),h=new Oe(r[l],P.getLength()-1).mod(P);a[l]=new Array(P.getLength()-1);for(var d=0;d<a[l].length;d++){const I=d+h.getLength()-a[l].length;a[l][d]=I>=0?h.get(I):0}}let u=0;for(var d=0;d<i.length;d++)u+=i[d].totalCount;const c=new Array(u);let m=0;for(var d=0;d<n;d++)for(var l=0;l<i.length;l++)d<r[l].length&&(c[m++]=r[l][d]);for(var d=0;d<s;d++)for(var l=0;l<i.length;l++)d<a[l].length&&(c[m++]=a[l][d]);return c}}Pe.PAD0=236;Pe.PAD1=17;const ne={L:1,M:0,Q:3,H:2},ae={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},we={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};class O{static getBCHTypeInfo(e){let i=e<<10;for(;O.getBCHDigit(i)-O.getBCHDigit(O.G15)>=0;)i^=O.G15<<O.getBCHDigit(i)-O.getBCHDigit(O.G15);return(e<<10|i)^O.G15_MASK}static getBCHTypeNumber(e){let i=e<<12;for(;O.getBCHDigit(i)-O.getBCHDigit(O.G18)>=0;)i^=O.G18<<O.getBCHDigit(i)-O.getBCHDigit(O.G18);return e<<12|i}static getBCHDigit(e){let i=0;for(;e!=0;)i++,e>>>=1;return i}static getPatternPosition(e){return O.PATTERN_POSITION_TABLE[e-1]}static getMask(e,i,o){switch(e){case we.PATTERN000:return(i+o)%2==0;case we.PATTERN001:return i%2==0;case we.PATTERN010:return o%3==0;case we.PATTERN011:return(i+o)%3==0;case we.PATTERN100:return(Math.floor(i/2)+Math.floor(o/3))%2==0;case we.PATTERN101:return i*o%2+i*o%3==0;case we.PATTERN110:return(i*o%2+i*o%3)%2==0;case we.PATTERN111:return(i*o%3+(i+o)%2)%2==0;default:throw new Error(`bad maskPattern:${e}`)}}static getErrorCorrectPolynomial(e){let i=new Oe([1],0);for(let o=0;o<e;o++)i=i.multiply(new Oe([1,J.gexp(o)],0));return i}static getLengthInBits(e,i){if(1<=i&&i<10)switch(e){case ae.MODE_NUMBER:return 10;case ae.MODE_ALPHA_NUM:return 9;case ae.MODE_8BIT_BYTE:return 8;case ae.MODE_KANJI:return 8;default:throw new Error(`mode:${e}`)}else if(i<27)switch(e){case ae.MODE_NUMBER:return 12;case ae.MODE_ALPHA_NUM:return 11;case ae.MODE_8BIT_BYTE:return 16;case ae.MODE_KANJI:return 10;default:throw new Error(`mode:${e}`)}else if(i<41)switch(e){case ae.MODE_NUMBER:return 14;case ae.MODE_ALPHA_NUM:return 13;case ae.MODE_8BIT_BYTE:return 16;case ae.MODE_KANJI:return 12;default:throw new Error(`mode:${e}`)}else throw new Error(`type:${i}`)}static getLostPoint(e){const i=e.getModuleCount();let o=0;for(var n=0;n<i;n++)for(var s=0;s<i;s++){let l=0;const d=e.isDark(n,s);for(let u=-1;u<=1;u++)if(!(n+u<0||i<=n+u))for(let c=-1;c<=1;c++)s+c<0||i<=s+c||u==0&&c==0||d==e.isDark(n+u,s+c)&&l++;l>5&&(o+=3+l-5)}for(var n=0;n<i-1;n++)for(var s=0;s<i-1;s++){let u=0;e.isDark(n,s)&&u++,e.isDark(n+1,s)&&u++,e.isDark(n,s+1)&&u++,e.isDark(n+1,s+1)&&u++,(u==0||u==4)&&(o+=3)}for(var n=0;n<i;n++)for(var s=0;s<i-6;s++)e.isDark(n,s)&&!e.isDark(n,s+1)&&e.isDark(n,s+2)&&e.isDark(n,s+3)&&e.isDark(n,s+4)&&!e.isDark(n,s+5)&&e.isDark(n,s+6)&&(o+=40);for(var s=0;s<i;s++)for(var n=0;n<i-6;n++)e.isDark(n,s)&&!e.isDark(n+1,s)&&e.isDark(n+2,s)&&e.isDark(n+3,s)&&e.isDark(n+4,s)&&!e.isDark(n+5,s)&&e.isDark(n+6,s)&&(o+=40);let r=0;for(var s=0;s<i;s++)for(var n=0;n<i;n++)e.isDark(n,s)&&r++;return o+=Math.abs(100*r/i/i-50)/5*10,o}}O.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];O.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0;O.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0;O.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1;class J{static glog(e){if(e<1)throw new Error(`glog(${e})`);return J.LOG_TABLE[e]}static gexp(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return J.EXP_TABLE[e]}}J.EXP_TABLE=new Array(256);J.LOG_TABLE=new Array(256);J._constructor=function(){for(var t=0;t<8;t++)J.EXP_TABLE[t]=1<<t;for(var t=8;t<256;t++)J.EXP_TABLE[t]=J.EXP_TABLE[t-4]^J.EXP_TABLE[t-5]^J.EXP_TABLE[t-6]^J.EXP_TABLE[t-8];for(var t=0;t<255;t++)J.LOG_TABLE[J.EXP_TABLE[t]]=t}();class Oe{constructor(e,i){if(e.length==null)throw new Error(`${e.length}/${i}`);let o=0;for(;o<e.length&&e[o]==0;)o++;this.num=new Array(e.length-o+i);for(let n=0;n<e.length-o;n++)this.num[n]=e[n+o]}get(e){return this.num[e]}getLength(){return this.num.length}multiply(e){const i=new Array(this.getLength()+e.getLength()-1);for(let o=0;o<this.getLength();o++)for(let n=0;n<e.getLength();n++)i[o+n]^=J.gexp(J.glog(this.get(o))+J.glog(e.get(n)));return new Oe(i,0)}mod(e){if(this.getLength()-e.getLength()<0)return this;const i=J.glog(this.get(0))-J.glog(e.get(0)),o=new Array(this.getLength());for(var n=0;n<this.getLength();n++)o[n]=this.get(n);for(var n=0;n<e.getLength();n++)o[n]^=J.gexp(J.glog(e.get(n))+i);return new Oe(o,0).mod(e)}}class Ae{constructor(e,i){this.totalCount=e,this.dataCount=i}static getRSBlocks(e,i){const o=Ae.getRsBlockTable(e,i);if(o==null)throw new Error(`bad rs block @ typeNumber:${e}/errorCorrectLevel:${i}`);const n=o.length/3,s=[];for(let r=0;r<n;r++){const a=o[r*3+0],l=o[r*3+1],d=o[r*3+2];for(let u=0;u<a;u++)s.push(new Ae(l,d))}return s}static getRsBlockTable(e,i){switch(i){case ne.L:return Ae.RS_BLOCK_TABLE[(e-1)*4+0];case ne.M:return Ae.RS_BLOCK_TABLE[(e-1)*4+1];case ne.Q:return Ae.RS_BLOCK_TABLE[(e-1)*4+2];case ne.H:return Ae.RS_BLOCK_TABLE[(e-1)*4+3];default:return}}}Ae.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];class kn{constructor(){this.buffer=[],this.length=0}get(e){const i=Math.floor(e/8);return(this.buffer[i]>>>7-e%8&1)==1}put(e,i){for(let o=0;o<i;o++)this.putBit((e>>>i-o-1&1)==1)}getLengthInBits(){return this.length}putBit(e){const i=Math.floor(this.length/8);this.buffer.length<=i&&this.buffer.push(0),e&&(this.buffer[i]|=128>>>this.length%8),this.length++}}const ve=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];var In=100,ee=256,Pt=ee-1,De=4,Gt=16,bt=1<<Gt,Kt=10,yt=10,En=bt>>yt,Dn=bt<<Kt-yt,$n=ee>>3,pt=6,Pn=1<<pt,Sn=$n*Pn,Bn=30,Xt=10,We=1<<Xt,Qt=8,St=1<<Qt,xn=Xt+Qt,ze=1<<xn,Bt=499,xt=491,Mt=487,Wt=503,Mn=3*Wt;function Tn(t,e){var i,o,n,s,r;function a(){i=[],o=new Int32Array(256),n=new Int32Array(ee),s=new Int32Array(ee),r=new Int32Array(ee>>3);var h,v;for(h=0;h<ee;h++)v=(h<<De+8)/ee,i[h]=new Float64Array([v,v,v,0]),s[h]=bt/ee,n[h]=0}function l(){for(var h=0;h<ee;h++)i[h][0]>>=De,i[h][1]>>=De,i[h][2]>>=De,i[h][3]=h}function d(h,v,I,f,b){i[v][0]-=h*(i[v][0]-I)/We,i[v][1]-=h*(i[v][1]-f)/We,i[v][2]-=h*(i[v][2]-b)/We}function u(h,v,I,f,b){for(var y=Math.abs(v-h),E=Math.min(v+h,ee),S=v+1,L=v-1,U=1,g,H;S<E||L>y;)H=r[U++],S<E&&(g=i[S++],g[0]-=H*(g[0]-I)/ze,g[1]-=H*(g[1]-f)/ze,g[2]-=H*(g[2]-b)/ze),L>y&&(g=i[L--],g[0]-=H*(g[0]-I)/ze,g[1]-=H*(g[1]-f)/ze,g[2]-=H*(g[2]-b)/ze)}function c(h,v,I){var f=2147483647,b=f,y=-1,E=y,S,L,U,g,H;for(S=0;S<ee;S++)L=i[S],U=Math.abs(L[0]-h)+Math.abs(L[1]-v)+Math.abs(L[2]-I),U<f&&(f=U,y=S),g=U-(n[S]>>Gt-De),g<b&&(b=g,E=S),H=s[S]>>yt,s[S]-=H,n[S]+=H<<Kt;return s[y]+=En,n[y]-=Dn,E}function m(){var h,v,I,f,b,y,E=0,S=0;for(h=0;h<ee;h++){for(I=i[h],b=h,y=I[1],v=h+1;v<ee;v++)f=i[v],f[1]<y&&(b=v,y=f[1]);if(f=i[b],h!=b&&(v=f[0],f[0]=I[0],I[0]=v,v=f[1],f[1]=I[1],I[1]=v,v=f[2],f[2]=I[2],I[2]=v,v=f[3],f[3]=I[3],I[3]=v),y!=E){for(o[E]=S+h>>1,v=E+1;v<y;v++)o[v]=h;E=y,S=h}}for(o[E]=S+Pt>>1,v=E+1;v<256;v++)o[v]=Pt}function A(h,v,I){for(var f,b,y,E=1e3,S=-1,L=o[v],U=L-1;L<ee||U>=0;)L<ee&&(b=i[L],y=b[1]-v,y>=E?L=ee:(L++,y<0&&(y=-y),f=b[0]-h,f<0&&(f=-f),y+=f,y<E&&(f=b[2]-I,f<0&&(f=-f),y+=f,y<E&&(E=y,S=b[3])))),U>=0&&(b=i[U],y=v-b[1],y>=E?U=-1:(U--,y<0&&(y=-y),f=b[0]-h,f<0&&(f=-f),y+=f,y<E&&(f=b[2]-I,f<0&&(f=-f),y+=f,y<E&&(E=y,S=b[3]))));return S}function $(){var h,v=t.length,I=30+(e-1)/3,f=v/(3*e),b=~~(f/In),y=We,E=Sn,S=E>>pt;for(S<=1&&(S=0),h=0;h<S;h++)r[h]=y*((S*S-h*h)*St/(S*S));var L;v<Mn?(e=1,L=3):v%Bt!==0?L=3*Bt:v%xt!==0?L=3*xt:v%Mt!==0?L=3*Mt:L=3*Wt;var U,g,H,D,G=0;for(h=0;h<f;)if(U=(t[G]&255)<<De,g=(t[G+1]&255)<<De,H=(t[G+2]&255)<<De,D=c(U,g,H),d(y,D,U,g,H),S!==0&&u(S,D,U,g,H),G+=L,G>=v&&(G-=v),h++,b===0&&(b=1),h%b===0)for(y-=y/I,E-=E/Bn,S=E>>pt,S<=1&&(S=0),D=0;D<S;D++)r[D]=y*((S*S-D*D)*St/(S*S))}function P(){a(),$(),l(),m()}this.buildColormap=P;function _(){for(var h=[],v=[],I=0;I<ee;I++)v[i[I][3]]=I;for(var f=0,b=0;b<ee;b++){var y=v[b];h[f++]=i[y][0],h[f++]=i[y][1],h[f++]=i[y][2]}return h}this.getColormap=_,this.lookupRGB=A}var Tt=-1,Je=12,Ue=5003,qn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function _n(t,e,i,o){var n=Math.max(2,o),s=new Uint8Array(256),r=new Int32Array(Ue),a=new Int32Array(Ue),l,d=0,u,c=0,m,A=!1,$,P,_,h,v,I;function f(D,G){s[u++]=D,u>=254&&L(G)}function b(D){y(Ue),c=P+2,A=!0,H(P,D)}function y(D){for(var G=0;G<D;++G)r[G]=-1}function E(D,G){var k,xe,W,fe,Ee,Z,he;for($=D,A=!1,I=$,m=U(I),P=1<<D-1,_=P+1,c=P+2,u=0,fe=g(),he=0,k=Ue;k<65536;k*=2)++he;he=8-he,Z=Ue,y(Z),H(P,G);e:for(;(xe=g())!=Tt;){if(k=(xe<<Je)+fe,W=xe<<he^fe,r[W]===k){fe=a[W];continue}else if(r[W]>=0){Ee=Z-W,W===0&&(Ee=1);do if((W-=Ee)<0&&(W+=Z),r[W]===k){fe=a[W];continue e}while(r[W]>=0)}H(fe,G),fe=xe,c<1<<Je?(a[W]=c++,r[W]=k):b(G)}H(fe,G),H(_,G)}function S(D){D.writeByte(n),h=t*e,v=0,E(n+1,D),D.writeByte(0)}function L(D){u>0&&(D.writeByte(u),D.writeBytes(s,0,u),u=0)}function U(D){return(1<<D)-1}function g(){if(h===0)return Tt;--h;var D=i[v++];return D&255}function H(D,G){for(l&=qn[d],d>0?l|=D<<d:l=D,d+=I;d>=8;)f(l&255,G),l>>=8,d-=8;if((c>m||A)&&(A?(m=U(I=$),A=!1):(++I,I==Je?m=1<<Je:m=U(I))),D==_){for(;d>0;)f(l&255,G),l>>=8,d-=8;L(G)}}this.encode=S}function se(){this.page=-1,this.pages=[],this.newPage()}se.pageSize=4096;se.charMap={};for(var Ze=0;Ze<256;Ze++)se.charMap[Ze]=String.fromCharCode(Ze);se.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(se.pageSize),this.cursor=0};se.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<se.pageSize;i++)t+=se.charMap[this.pages[e][i]];return t};se.prototype.toFlattenUint8Array=function(){const t=[];for(var e=0;e<this.pages.length;e++)if(e===this.pages.length-1){const o=Uint8Array.from(this.pages[e].slice(0,this.cursor));t.push(o)}else t.push(this.pages[e]);const i=new Uint8Array(t.reduce((o,n)=>o+n.length,0));return t.reduce((o,n)=>(i.set(n,o),o+n.length),0),i};se.prototype.writeByte=function(t){this.cursor>=se.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t};se.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))};se.prototype.writeBytes=function(t,e,i){for(var o=i||t.length,n=e||0;n<o;n++)this.writeByte(t[n])};function K(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new se}K.prototype.setDelay=function(t){this.delay=Math.round(t/10)};K.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)};K.prototype.setDispose=function(t){t>=0&&(this.dispose=t)};K.prototype.setRepeat=function(t){this.repeat=t};K.prototype.setTransparent=function(t){this.transparent=t};K.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};K.prototype.finish=function(){this.out.writeByte(59)};K.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t};K.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t};K.prototype.setGlobalPalette=function(t){this.globalPalette=t};K.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};K.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};K.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new Tn(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};K.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,o=0;o<e;o++){var n=this.findClosestRGB(this.pixels[i++]&255,this.pixels[i++]&255,this.pixels[i++]&255);this.usedEntry[n]=!0,this.indexedPixels[o]=n}};K.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var o=i[t],n=0,s=this.height,r=this.width,a=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var d=0;d<s;d++){e&&(l=l*-1);for(var u=l==1?0:r-1,c=l==1?r:0;u!==c;u+=l){n=d*r+u;var m=n*3,A=a[m],$=a[m+1],P=a[m+2];m=this.findClosestRGB(A,$,P),this.usedEntry[m]=!0,this.indexedPixels[n]=m,m*=3;for(var _=this.colorTab[m],h=this.colorTab[m+1],v=this.colorTab[m+2],I=A-_,f=$-h,b=P-v,y=l==1?0:o.length-1,E=l==1?o.length:0;y!==E;y+=l){var S=o[y][1],L=o[y][2];if(S+u>=0&&S+u<r&&L+d>=0&&L+d<s){var U=o[y][0];m=n+S+L*r,m*=3,a[m]=Math.max(0,Math.min(255,a[m]+I*U)),a[m+1]=Math.max(0,Math.min(255,a[m+1]+f*U)),a[m+2]=Math.max(0,Math.min(255,a[m+2]+b*U))}}}}};K.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)};K.prototype.findClosestRGB=function(t,e,i,o){if(this.colorTab===null)return-1;if(this.neuQuant&&!o)return this.neuQuant.lookupRGB(t,e,i);for(var n=0,s=256*256*256,r=this.colorTab.length,a=0,l=0;a<r;l++){var d=t-(this.colorTab[a++]&255),u=e-(this.colorTab[a++]&255),c=i-(this.colorTab[a++]&255),m=d*d+u*u+c*c;(!o||this.usedEntry[l])&&m<s&&(s=m,n=l)}return n};K.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,o=0,n=0,s=0;s<e;s++)for(var r=0;r<t;r++)this.pixels[n++]=i[o++],this.pixels[n++]=i[o++],this.pixels[n++]=i[o++],o++};K.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};K.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};K.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};K.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};K.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)};K.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)};K.prototype.writePixels=function(){var t=new _n(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)};K.prototype.stream=function(){return this.out};var Ln=globalThis&&globalThis.__awaiter||function(t,e,i,o){function n(s){return s instanceof i?s:new i(function(r){r(s)})}return new(i||(i=Promise))(function(s,r){function a(u){try{d(o.next(u))}catch(c){r(c)}}function l(u){try{d(o.throw(u))}catch(c){r(c)}}function d(u){u.done?s(u.value):n(u.value).then(a,l)}d((o=o.apply(t,e||[])).next())})};const{Canvas:ye}=nn,Ye=.4;function qt(t){if(!t)return;function e(i){i.onload=null,i.onerror=null}return new Promise(function(i,o){if(t.slice(0,4)=="data"){let s=new Image;s.onload=function(){i(s),e(s)},s.onerror=function(){o("Image load error"),e(s)},s.src=t;return}let n=new Image;n.setAttribute("crossOrigin","Anonymous"),n.onload=function(){i(n)},n.onerror=function(){o("Image load error")},n.src=t})}class F{constructor(e){const i=Object.assign({},e);if(Object.keys(F.defaultOptions).forEach(o=>{o in i||Object.defineProperty(i,o,{value:F.defaultOptions[o],enumerable:!0,writable:!0})}),i.components?typeof i.components=="object"&&Object.keys(F.defaultComponentOptions).forEach(o=>{o in i.components?Object.defineProperty(i.components,o,{value:Object.assign(Object.assign({},F.defaultComponentOptions[o]),i.components[o]),enumerable:!0,writable:!0}):Object.defineProperty(i.components,o,{value:F.defaultComponentOptions[o],enumerable:!0,writable:!0})}):i.components=F.defaultComponentOptions,i.dotScale!==null&&i.dotScale!==void 0){if(i.dotScale<=0||i.dotScale>1)throw new Error("dotScale should be in range (0, 1].");i.components.data.scale=i.dotScale,i.components.timing.scale=i.dotScale,i.components.alignment.scale=i.dotScale}this.options=i,this.canvas=new ye(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new Pe(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}draw(){return new Promise(e=>this._draw().then(e))}_clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}static _prepareRoundedCornerClip(e,i,o,n,s,r){e.beginPath(),e.moveTo(i,o),e.arcTo(i+n,o,i+n,o+s,r),e.arcTo(i+n,o+s,i,o+s,r),e.arcTo(i,o+s,i,o,r),e.arcTo(i,o,i+n,o,r),e.closePath()}static _getAverageRGB(e){const o={r:0,g:0,b:0};let n,s,r=-4;const a={r:0,g:0,b:0};let l=0;s=e.naturalHeight||e.height,n=e.naturalWidth||e.width;const u=new ye(n,s).getContext("2d");if(!u)return o;u.drawImage(e,0,0);let c;try{c=u.getImageData(0,0,n,s)}catch{return o}for(;(r+=5*4)<c.data.length;)c.data[r]>200||c.data[r+1]>200||c.data[r+2]>200||(++l,a.r+=c.data[r],a.g+=c.data[r+1],a.b+=c.data[r+2]);return a.r=~~(a.r/l),a.g=~~(a.g/l),a.b=~~(a.b/l),a}static _drawDot(e,i,o,n,s=0,r=1){e.fillRect((i+s)*n,(o+s)*n,r*n,r*n)}static _drawAlignProtector(e,i,o,n){e.clearRect((i-2)*n,(o-2)*n,5*n,5*n),e.fillRect((i-2)*n,(o-2)*n,5*n,5*n)}static _drawAlign(e,i,o,n,s=0,r=1,a,l){const d=e.fillStyle;e.fillStyle=a,new Array(4).fill(0).map((u,c)=>{F._drawDot(e,i-2+c,o-2,n,s,r),F._drawDot(e,i+2,o-2+c,n,s,r),F._drawDot(e,i+2-c,o+2,n,s,r),F._drawDot(e,i-2,o+2-c,n,s,r)}),F._drawDot(e,i,o,n,s,r),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map((u,c)=>{F._drawDot(e,i-1+c,o-1,n,s,r),F._drawDot(e,i+1,o-1+c,n,s,r),F._drawDot(e,i+1-c,o+1,n,s,r),F._drawDot(e,i-1,o+1-c,n,s,r)})),e.fillStyle=d}_draw(){var e,i,o,n,s,r,a,l,d,u,c,m,A,$,P,_,h,v,I;return Ln(this,void 0,void 0,function*(){const f=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,b=this.options.size;let y=this.options.margin;(y<0||y*2>=b)&&(y=0);const E=Math.ceil(y),S=b-2*y,L=this.options.whiteMargin,U=this.options.backgroundDimming,g=Math.ceil(S/f),H=g*f,D=H+2*E,G=new ye(D,D),k=G.getContext("2d");this._clear(),k.save(),k.translate(E,E);const xe=new ye(D,D),W=xe.getContext("2d");let fe=null,Ee=[];if(this.options.gifBackground){const M=mn(this.options.gifBackground);if(fe=M,Ee=yn(M,!0),this.options.autoColor){let q=0,N=0,z=0,Y=0;for(let X=0;X<Ee[0].colorTable.length;X++){const Q=Ee[0].colorTable[X];Q[0]>200||Q[1]>200||Q[2]>200||Q[0]===0&&Q[1]===0&&Q[2]===0||(Y++,q+=Q[0],N+=Q[1],z+=Q[2])}q=~~(q/Y),N=~~(N/Y),z=~~(z/Y),this.options.colorDark=`rgb(${q},${N},${z})`}}else if(this.options.backgroundImage){const M=yield qt(this.options.backgroundImage);if(this.options.autoColor){const q=F._getAverageRGB(M);this.options.colorDark=`rgb(${q.r},${q.g},${q.b})`}W.drawImage(M,0,0,M.width,M.height,0,0,D,D),W.rect(0,0,D,D),W.fillStyle=U,W.fill()}else W.rect(0,0,D,D),W.fillStyle=this.options.colorLight,W.fill();const Z=O.getPatternPosition(this.qrCode.typeNumber),he=((o=(i=this.options.components)===null||i===void 0?void 0:i.data)===null||o===void 0?void 0:o.scale)||Ye,wt=(1-he)*.5;for(let M=0;M<f;M++)for(let q=0;q<f;q++){const N=this.qrCode.isDark(M,q),z=q<8&&(M<8||M>=f-8)||q>=f-8&&M<8,Y=M==6&&q>=8&&q<=f-8||q==6&&M>=8&&M<=f-8;let X=z||Y;for(let oe=1;oe<Z.length-1;oe++)X=X||M>=Z[oe]-2&&M<=Z[oe]+2&&q>=Z[oe]-2&&q<=Z[oe]+2;const Q=q*g+(X?0:wt*g),ge=M*g+(X?0:wt*g);if(k.strokeStyle=N?this.options.colorDark:this.options.colorLight,k.lineWidth=.5,k.fillStyle=N?this.options.colorDark:this.options.colorLight,Z.length===0)X||k.fillRect(Q,ge,(X?1:he)*g,(X?1:he)*g);else{const oe=q<f-4&&q>=f-4-5&&M<f-4&&M>=f-4-5;!X&&!oe&&k.fillRect(Q,ge,(X?1:he)*g,(X?1:he)*g)}}const le=Z[Z.length-1],Jt=this.options.colorLight;if(k.fillStyle=Jt,k.fillRect(0,0,8*g,8*g),k.fillRect(0,(f-8)*g,8*g,8*g),k.fillRect((f-8)*g,0,8*g,8*g),!((s=(n=this.options.components)===null||n===void 0?void 0:n.timing)===null||s===void 0)&&s.protectors&&(k.fillRect(8*g,6*g,(f-8-8)*g,g),k.fillRect(6*g,8*g,g,(f-8-8)*g)),!((a=(r=this.options.components)===null||r===void 0?void 0:r.cornerAlignment)===null||a===void 0)&&a.protectors&&F._drawAlignProtector(k,le,le,g),!((d=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||d===void 0)&&d.protectors)for(let M=0;M<Z.length;M++)for(let q=0;q<Z.length;q++){const N=Z[q],z=Z[M];if(!(N===6&&(z===6||z===le))){if(z===6&&(N===6||N===le))continue;if(N===le&&z===le)continue;F._drawAlignProtector(k,N,z,g)}}k.fillStyle=this.options.colorDark,k.fillRect(0,0,7*g,g),k.fillRect((f-7)*g,0,7*g,g),k.fillRect(0,6*g,7*g,g),k.fillRect((f-7)*g,6*g,7*g,g),k.fillRect(0,(f-7)*g,7*g,g),k.fillRect(0,(f-7+6)*g,7*g,g),k.fillRect(0,0,g,7*g),k.fillRect(6*g,0,g,7*g),k.fillRect((f-7)*g,0,g,7*g),k.fillRect((f-7+6)*g,0,g,7*g),k.fillRect(0,(f-7)*g,g,7*g),k.fillRect(6*g,(f-7)*g,g,7*g),k.fillRect(2*g,2*g,3*g,3*g),k.fillRect((f-7+2)*g,2*g,3*g,3*g),k.fillRect(2*g,(f-7+2)*g,3*g,3*g);const at=((c=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||c===void 0?void 0:c.scale)||Ye,At=(1-at)*.5;for(let M=0;M<f-8;M+=2)F._drawDot(k,8+M,6,g,At,at),F._drawDot(k,6,8+M,g,At,at);const Ct=((A=(m=this.options.components)===null||m===void 0?void 0:m.cornerAlignment)===null||A===void 0?void 0:A.scale)||Ye,Zt=(1-Ct)*.5;F._drawAlign(k,le,le,g,Zt,Ct,this.options.colorDark,((P=($=this.options.components)===null||$===void 0?void 0:$.cornerAlignment)===null||P===void 0?void 0:P.protectors)||!1);const kt=((h=(_=this.options.components)===null||_===void 0?void 0:_.alignment)===null||h===void 0?void 0:h.scale)||Ye,Yt=(1-kt)*.5;for(let M=0;M<Z.length;M++)for(let q=0;q<Z.length;q++){const N=Z[q],z=Z[M];if(!(N===6&&(z===6||z===le))){if(z===6&&(N===6||N===le))continue;if(N===le&&z===le)continue;F._drawAlign(k,N,z,g,Yt,kt,this.options.colorDark,((I=(v=this.options.components)===null||v===void 0?void 0:v.alignment)===null||I===void 0?void 0:I.protectors)||!1)}}if(L&&(k.fillStyle=this.options.backgroundColor,k.fillRect(-E,-E,D,E),k.fillRect(-E,H,D,E),k.fillRect(H,-E,E,D),k.fillRect(-E,-E,E,D)),this.options.logoImage){const M=yield qt(this.options.logoImage);let q=this.options.logoScale,N=this.options.logoMargin,z=this.options.logoCornerRadius;(q<=0||q>=1)&&(q=.2),N<0&&(N=0),z<0&&(z=0);const Y=H*q,X=.5*(D-Y),Q=X;k.restore(),k.fillStyle=this.options.logoBackgroundColor,k.save(),F._prepareRoundedCornerClip(k,X-N,Q-N,Y+2*N,Y+2*N,z+N),k.clip();const ge=k.globalCompositeOperation;k.globalCompositeOperation="destination-out",k.fill(),k.globalCompositeOperation=ge,k.restore(),k.save(),F._prepareRoundedCornerClip(k,X,Q,Y,Y,z),k.clip(),k.drawImage(M,X,Q,Y,Y),k.restore(),k.save(),k.translate(E,E)}if(fe){let M,q,N,z,Y,X;if(Ee.forEach(function(Q){M||(M=new K(b,b),M.setDelay(Q.delay),M.setRepeat(0));const{width:ge,height:oe}=Q.dims;q||(q=new ye(ge,oe),N=q.getContext("2d"),N.rect(0,0,q.width,q.height),N.fillStyle="#ffffff",N.fill()),(!z||!X||ge!==z.width||oe!==z.height)&&(z=new ye(ge,oe),Y=z.getContext("2d"),X=Y.createImageData(ge,oe)),X.data.set(Q.patch),Y.putImageData(X,0,0),N.drawImage(z.getContext("2d").canvas,Q.dims.left,Q.dims.top);const Xe=new ye(D,D),Re=Xe.getContext("2d");Re.drawImage(q.getContext("2d").canvas,0,0,D,D),Re.rect(0,0,D,D),Re.fillStyle=U,Re.fill(),Re.drawImage(G.getContext("2d").canvas,0,0,D,D);const rt=new ye(b,b),It=rt.getContext("2d");It.drawImage(Xe.getContext("2d").canvas,0,0,b,b),M.addFrame(It.getImageData(0,0,rt.width,rt.height).data)}),!M)throw new Error("No frames.");if(M.finish(),_t(this.canvas)){const ge=M.stream().toFlattenUint8Array().reduce((oe,Xe)=>oe+String.fromCharCode(Xe),"");return Promise.resolve(`data:image/gif;base64,${window.btoa(ge)}`)}return Promise.resolve(Buffer.from(M.stream().toFlattenUint8Array()))}else{W.drawImage(G.getContext("2d").canvas,0,0,D,D),k.drawImage(xe.getContext("2d").canvas,-E,-E,D,D);const M=new ye(b,b);M.getContext("2d").drawImage(G.getContext("2d").canvas,0,0,b,b),this.canvas=M;const N=this.options.gifBackground?"gif":"png";return _t(this.canvas)?Promise.resolve(this.canvas.toDataURL(N)):Promise.resolve(this.canvas.toBuffer(N))}})}}F.CorrectLevel=ne;F.defaultComponentOptions={data:{scale:.4},timing:{scale:.5,protectors:!1},alignment:{scale:.5,protectors:!1},cornerAlignment:{scale:.5,protectors:!0}};F.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"rgba(255, 255, 255, 0.6)",correctLevel:ne.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:F.defaultComponentOptions,autoColor:!0,logoBackgroundColor:"#ffffff",backgroundColor:"#ffffff"};function _t(t){try{return t instanceof HTMLElement}catch{return typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}}const Nn={props:{text:{type:String,required:!0},qid:{type:String},correctLevel:{type:Number,default:1},size:{type:Number,default:200},margin:{type:Number,default:20},colorDark:{type:String,default:"#000000"},colorLight:{type:String,default:"#FFFFFF"},bgSrc:{type:String,default:void 0},background:{type:String,default:"rgba(0,0,0,0)"},backgroundDimming:{type:String,default:"rgba(0,0,0,0)"},logoSrc:{type:String,default:void 0},logoBackgroundColor:{type:String,default:"rgba(255,255,255,1)"},gifBgSrc:{type:String,default:void 0},logoScale:{type:Number,default:.2},logoMargin:{type:Number,default:0},logoCornerRadius:{type:Number,default:8},whiteMargin:{type:[Boolean,String],default:!0},dotScale:{type:Number,default:1},autoColor:{type:[Boolean,String],default:!0},binarize:{type:[Boolean,String],default:!1},binarizeThreshold:{type:Number,default:128},callback:{type:Function,default:function(){}},bindElement:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#FFFFFF"},components:{default:function(){return{data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}}}}},name:"vue-qr",data(){return{imgUrl:""}},watch:{$props:{deep:!0,handler(){this.main()}}},mounted(){this.main()},methods:{async main(){if(this.gifBgSrc){const i=await _o(this.gifBgSrc),o=this.logoSrc;this.render(void 0,o,i);return}const t=this.bgSrc,e=this.logoSrc;this.render(t,e)},async render(t,e,i){const o=this;new F({gifBackground:i,text:o.text,size:o.size,margin:o.margin,colorDark:o.colorDark,colorLight:o.colorLight,backgroundColor:o.backgroundColor,backgroundImage:t,backgroundDimming:o.backgroundDimming,logoImage:e,logoScale:o.logoScale,logoBackgroundColor:o.logoBackgroundColor,correctLevel:o.correctLevel,logoMargin:o.logoMargin,logoCornerRadius:o.logoCornerRadius,whiteMargin:lt(o.whiteMargin),dotScale:o.dotScale,autoColor:lt(o.autoColor),binarize:lt(o.binarize),binarizeThreshold:o.binarizeThreshold,components:o.components}).draw().then(n=>{this.imgUrl=n,o.callback&&o.callback(n,o.qid)})}}},zn=["src"];function Vn(t,e,i,o,n,s){return i.bindElement?(w(),T("img",{key:0,style:{display:"inline-block"},src:n.imgUrl},null,8,zn)):me("",!0)}var Fn=Ie(Nn,[["render",Vn]]);const On=Be({name:"AssetDetailsPage",components:{GoBackButton:bi,SecondaryNavbarButton:Ai,AssetInfo:ji,AssetActions:wo,MoreOptionsButton:hi,DialogConfirmDelete:gi,vueQr:Fn,AssetAttachments:qo},setup(){const t=x(e());function e(){const f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),b=window.innerWidth<1024;return f||b}window.addEventListener("resize",()=>{t.value=e()});const i=ri(),o=Ke();o.params.id||(console.log("a"),o.push({name:"assets-page"}));const n=x(o.params.id),s=x("details"),r=x(tt),a=x([{label:"Ver codigo QR",icon:"qr_code",color:"black",value:"view-qr"},{label:"Borrar",icon:"delete",color:"red",value:"delete-asset"}]),l=x(!1),d=x([{label:"Detalles",state:!0},{label:"Acciones",state:!1},{label:"Archivos adjuntados",state:!1}]),u=x({}),c=x(!1);ke(n,(f,b)=>{m(f)});function m(f){try{Ce.get(`./assets/${f}`).then(b=>{const y=b.data;y?(u.value=y,$.value=P(y.actions),c.value=!0):c.value="failed"}).catch(b=>{c.value="failed",console.log(b)})}catch(b){c.value="failed",console.log(b)}}m(n.value);const A=[{name:"index",label:"#",field:"index"},{name:"name",label:"Nombre",field:"name",align:"left"},{name:"description",label:"Descripci\xF3n",field:"description",align:"left"},{name:"status",label:"Estado",field:"status",align:"left"},{name:"attachments",label:"Imagenes y videos",field:"attachments",align:"left"},{name:"date",label:"Fecha de creaci\xF3n",field:"date",align:"left",format:f=>_(f),sortable:!0,sort:(f,b)=>new Date(b)-new Date(f)},{name:"actions",label:"",align:"left"}],$=x();function P(f){return f.sort((b,y)=>new Date(y.date)-new Date(b.date)),f}function _(f){return Nt.formatDate(f,"DD/MMMM/YYYY - HH:mm",{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]})}const h=x(!1),v=x(!1),I=x(!1);return{isMobile:t,$q:i,router:o,idAsset:n,getAssetDetails:m,assetInfo:u,detailsLoaded:c,actualSection:s,assetMoreOptions:a,dialogConfirmDeleteState:l,pageSections:d,assetActionsColumns:A,sortedActions:$,stateQrDialog:h,contentToPrint:v,imageServer:r,expandSectionBar:I}},methods:{handleOptionClick(t){if(t==="delete-asset")return this.deleteAsset();t==="view-qr"&&(console.log("QR"),this.openQrDialog())},emitEventUpdateNotifications(){this.$emit("updateNotifications")},goToSection(t){this.pageSections.map(e=>{e.label===t?(e.state=!0,this.expandSectionBar==!0&&(this.expandSectionBar=!1)):e.state=!1})},deleteAsset(t=!1){if(t===!1)return this.$refs.dialogConfirmDeleteRef.openDialog();Ce.delete(`./assets/delete/${this.idAsset}`).then(e=>{e.status===200?(this.$q.notify({type:"warning",message:"Borrado correctamente.",timeout:2500}),this.$router.push({name:"assets-page"}),this.emitEventUpdateNotifications()):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(e=>{this.$q.notify({type:"negative",message:`Ha ocurrido un error. ${e.message}`,timeout:2e3})})},defineStatusColor(t){if(t==="Activo"||t==="Con stock")return"green";if(t==="Inactivo"||t==="Bajo stock")return"orange";if(t==="Roto"||t==="Sin stock")return"red"},openQrDialog(){this.stateQrDialog=!0},closeQrDialog(){this.stateQrDialog=!1},printQr(){this.stateQrDialog=!1,this.contentToPrint=!0,setTimeout(()=>{window.print(),this.contentToPrint=!1},500)}}}),Rn={class:"col-12 col-sm-12 col-md-3 bg-grey-2 flex",style:{"border-radius":"12px","flex-direction":"column"}},Un={class:"q-pa-md"},jn={class:"flex justify-between"},Hn={key:0,class:"text-h6 q-pr-md"},Gn={key:1,class:"text-h6 q-pr-md"},Kn={key:2},Xn={key:3},Qn={key:0,class:"text-grey-14"},Wn={key:1,class:"text-grey-14"},Jn={key:0},Zn={key:0},Yn={key:1},es={class:"flex justify-end"},ts={key:0,class:"flex justify-center items-center q-pa-xl q-ma-xl"},is=B("div",{class:"full-width text-center"}," Cargando informaci\xF3n del producto ",-1),os={key:1,class:"flex justify-center items-center q-pa-xl q-ma-xl"},ns=B("div",{class:"full-width text-center q-py-lg text-h6"}," Error al cargar el producto ",-1),ss=B("div",{class:"full-width text-center q-pb-md"}," Vuelve a seleccionar el producto en la seccion del inventario. ",-1),as={key:0,class:"text-h6"},rs={key:1,class:"text-h6"},ls={key:0,class:"text-grey-14 full-width text-center",style:{"font-size":"0.75rem"}},ds={key:1,class:"text-grey-14 full-width text-center",style:{"font-size":"0.75rem"}},cs={key:0,class:"text-grey-14 full-width text-center",style:{"font-size":"6px"}},us={key:1,class:"text-grey-14 full-width text-center",style:{"font-size":"6px"}};function fs(t,e,i,o,n,s){const r=re("GoBackButton"),a=re("MoreOptionsButton"),l=re("q-section"),d=re("SecondaryNavbarButton"),u=re("AssetInfo"),c=re("AssetActions"),m=re("AssetAttachments"),A=re("DialogConfirmDelete"),$=re("vue-qr");return w(),j(li,null,{default:C(()=>[p(l,{class:"flex justify-between q-px-md q-py-sm"},{default:C(()=>[p(r),p(a,{options:t.assetMoreOptions,onOptionClicked:t.handleOptionClick},null,8,["options","onOptionClicked"])]),_:1}),Object.keys(t.assetInfo).length>0&&t.detailsLoaded===!0?(w(),j(l,{key:0,class:"flex row q-px-md",style:ce({height:"73vh",overflowY:t.isMobile?"auto":""})},{default:C(()=>{var P,_;return[B("div",Rn,[B("div",Un,[B("div",jn,[t.assetInfo.model?(w(),T("div",Hn,V(t.assetInfo.category)+" "+V(t.assetInfo.model),1)):(w(),T("div",Gn,V(t.assetInfo.category)+" "+V(t.assetInfo.description),1)),(P=t.assetInfo.status)!=null&&P.name?(w(),T("div",Kn,[p(Se,{name:"circle",color:t.defineStatusColor((_=t.assetInfo.status)==null?void 0:_.name)},null,8,["color"]),ie(" \xA0 "+V(t.assetInfo.status.name),1)])):(w(),T("div",Xn,[p(Se,{name:"circle",color:"black"}),ie(" \xA0 Sin definir ")]))]),t.assetInfo.serial_number?(w(),T("div",Qn,"#"+V(t.assetInfo.serial_number),1)):(w(),T("div",Wn,"#General"))]),B("div",{class:"q-py-lg",style:ce({paddingTop:t.isMobile?"5px":"",paddingBottom:t.isMobile?"10px":""})},[(w(!0),T(Me,null,He(t.pageSections,(h,v)=>(w(),T("div",{key:v+1},[t.isMobile?(w(),T("div",Jn,[t.expandSectionBar==!0||h.state?(w(),T("div",Zn,[p(d,{class:"full-width",borderPosition:"left",label:h.label,active:h.state,onClick:I=>t.goToSection(h.label)},null,8,["label","active","onClick"])])):me("",!0)])):(w(),T("div",Yn,[p(d,{class:"full-width",borderPosition:"left",label:h.label,active:h.state,onClick:I=>t.goToSection(h.label)},null,8,["label","active","onClick"])]))]))),128)),B("div",es,[t.isMobile&&t.expandSectionBar==!0?(w(),j(R,{key:0,icon:"expand_less",flat:"",size:"14px",class:"full-width",style:{"border-radius":"5px"},onClick:e[0]||(e[0]=h=>t.expandSectionBar=!1)})):t.isMobile&&t.expandSectionBar==!1?(w(),j(R,{key:1,icon:"expand_more",flat:"",size:"14px",class:"full-width",style:{"border-radius":"5px"},onClick:e[1]||(e[1]=h=>t.expandSectionBar=!0)})):me("",!0)])],4)]),B("div",{class:"col-12 col-sm-12 col-md-9 q-px-lg q-py-sm",style:ce({overflowY:t.isMobile?"":"auto",paddingLeft:t.isMobile?"0":"",paddingRight:t.isMobile?"0":""})},[t.detailsLoaded===!0&&t.pageSections[0].state?(w(),j(u,{key:0,modelInfo:t.assetInfo,onUpdateInfo:e[2]||(e[2]=()=>{t.getAssetDetails(t.idAsset),t.emitEventUpdateNotifications()})},null,8,["modelInfo"])):me("",!0),t.detailsLoaded===!0&&t.pageSections[1].state?(w(),j(c,{key:1,columns:t.assetActionsColumns,rows:t.sortedActions,onUpdateInfo:e[3]||(e[3]=()=>{t.getAssetDetails(t.idAsset),t.emitEventUpdateNotifications()})},null,8,["columns","rows"])):me("",!0),t.detailsLoaded===!0&&t.pageSections[2].state?(w(),j(m,{key:2,asset:t.assetInfo,onUpdateInfo:e[4]||(e[4]=()=>{t.getAssetDetails(t.idAsset),t.emitEventUpdateNotifications()})},null,8,["asset"])):me("",!0)],4)]}),_:1},8,["style"])):(w(),j(l,{key:1},{default:C(()=>[t.detailsLoaded===!1?(w(),T("div",ts,[is,p(ai,{color:"primary",size:"32px"})])):t.detailsLoaded=="failed"?(w(),T("div",os,[p(Se,{name:"error",color:"red",size:"128px"}),ns,ss,p(R,{label:"Regresar al inventario",color:"dark",style:{"text-transform":"none","border-radius":"5px"},to:"../inventario"})])):me("",!0)]),_:1})),p(A,{ref:"dialogConfirmDeleteRef",label:t.assetInfo.model?t.assetInfo.model:t.assetInfo.description,onDeleteConfirm:t.deleteAsset},null,8,["label","onDeleteConfirm"]),p(Te,{modelValue:t.stateQrDialog,"onUpdate:modelValue":e[6]||(e[6]=P=>t.stateQrDialog=P)},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"500px","max-width":"80vw"}},{default:C(()=>[p(de,{align:"right",class:"q-py-none"},{default:C(()=>[Ge(p(R,{icon:"close",color:"black",flat:"",round:"",class:"q-py-none"},null,512),[[et]])]),_:1}),p(te,{class:"q-pt-none q-pb-md",style:{"border-bottom":"1px solid #e9e9e9"}},{default:C(()=>[t.assetInfo.model?(w(),T("div",as,V(t.assetInfo.category)+" "+V(t.assetInfo.model),1)):(w(),T("div",rs,V(t.assetInfo.category)+" "+V(t.assetInfo.description),1))]),_:1}),p(de,{class:"q-pb-none q-mb-none",align:"right"},{default:C(()=>[p(R,{flat:"",round:"",icon:"print",color:"primary",size:"0.95rem",onClick:e[5]||(e[5]=P=>t.printQr())},{default:C(()=>[p(_e,{class:"bg-black",style:{"font-size":"0.75rem"}},{default:C(()=>[ie("Imprimir")]),_:1})]),_:1})]),_:1}),p(te,{class:"flex justify-center items-center q-pt-none q-mt-none"},{default:C(()=>[p($,{text:t.assetInfo._id,size:"300"},null,8,["text"]),t.assetInfo.serial_number?(w(),T("div",ls,V(t.assetInfo.category)+" "+V(t.assetInfo.serial_number),1)):(w(),T("div",ds,V(t.assetInfo.category)+"&"+V(t.assetInfo.description),1)),p(Fe,{src:t.imageServer+"/uploads/attachments/masterbrand-full-logo.jpg","spinner-color":"primary",style:{width:"200px",opacity:"0.7"}},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),p(Te,{modelValue:t.contentToPrint,"onUpdate:modelValue":e[7]||(e[7]=P=>t.contentToPrint=P)},{default:C(()=>[p($e,{class:"q-pa-md",style:{width:"200px"}},{default:C(()=>[p(te,{class:"flex justify-center items-center"},{default:C(()=>[p($,{text:t.assetInfo._id,size:"150"},null,8,["text"]),t.assetInfo.serial_number?(w(),T("div",cs,V(t.assetInfo.category)+" "+V(t.assetInfo.serial_number),1)):(w(),T("div",us,V(t.assetInfo.category)+"&"+V(t.assetInfo.description),1)),p(Fe,{src:t.imageServer+"/uploads/attachments/masterbrand-full-logo.jpg",style:{width:"100px",opacity:"0.7"}},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ps=Ie(On,[["render",fs]]);export{Ps as default};
