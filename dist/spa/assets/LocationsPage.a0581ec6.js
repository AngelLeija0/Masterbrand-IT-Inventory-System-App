import{P as C,d as $,f as v}from"./PrimaryButton.ed2de242.js";import{b as w,a as k,Q as P}from"./QPage.90f527e3.js";import{api as N}from"./axios.d5763ff0.js";import{u as B}from"./data-api-store.96a98ce2.js";import{P as Q}from"./PageTitle.9a2d5f9a.js";import{F as S}from"./FilterBar.ccc1d6e5.js";import{D as M}from"./DetailsTable.162e0ec0.js";import{d as L,r as f,_ as q,G as m,y as b,z as A,C as i,f as t,Q as D,N as h,E as I,J as _}from"./index.d76d729d.js";import{u as R,Q as y}from"./use-quasar.8b1fb4cd.js";import{Q as U}from"./QInput.256b5391.js";import{Q as V}from"./QTooltip.e068c045.js";import"./use-dark.dd39b0a6.js";import"./uid.55d387d1.js";import"./QBtnDropdown.f3e529f4.js";import"./QTable.d3ac5408.js";import"./QSpinnerDots.a9a067c5.js";const E=L({name:"DialogNewLocation",setup(){R();const e=f(!1),o=f({}),r=f({name:[n=>!!n||"* Requerido",n=>n.length<30||"Porfavor usa un maximo de 30 caracteres",n=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(n)||"No se permiten caracteres especiales"]});return{dialogState:e,inputInfo:o,inputRulesDictionary:r}},methods:{openDialog(){this.dialogState=!0},closeDialog(){this.dialogState=!1,this.inputInfo={}},addLocation(){this.inputInfo.created_at=new Date,N.post("./locations/create",this.inputInfo).then(e=>{e.data?(this.$q.notify({type:"positive",message:"Creado correctamente.",timeout:2e3}),this.dialogState=!1,this.$emit("locationAdded")):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(e=>{console.log(e),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}),this.inputInfo={}},validateForm(){const e=[];if(Object.keys(this.inputInfo).length>0)Object.keys(this.inputInfo).map(o=>{const r=this.inputInfo[o];if(r){const n=this.inputRulesDictionary[o];for(const p of n)p(r)!==!0?e.push(!1):e.push(!0)}else return e.push(!1)});else return!1;return!e.includes(!1)}}}),F=h("div",{class:"text-h5 text-weight-medium"},"Nueva Ubicaci\xF3n",-1),z={class:"q-mb-lg"},T={class:"q-mb-lg q-pt-md"},O=h("div",{class:"col-12 q-pt-sm text-weight-medium"},"Nombre",-1);function x(e,o,r,n,p,d){const c=m("q-title");return b(),A(V,{modelValue:e.dialogState,"onUpdate:modelValue":o[1]||(o[1]=l=>e.dialogState=l),persistent:"",transparent:""},{default:i(()=>[t(k,{class:"q-pa-md",style:{width:"700px","max-width":"80vw","max-height":"80vh"}},{default:i(()=>[t(y,{align:"right",class:"q-py-none"},{default:i(()=>[t(D,{icon:"close",color:"black",flat:"",round:"",onClick:e.closeDialog,class:"q-py-none"},null,8,["onClick"])]),_:1}),t(w,{class:"q-pt-none q-pb-sm",style:{"border-bottom":"1px solid #e9e9e9"}},{default:i(()=>[F]),_:1}),t(w,null,{default:i(()=>[h("div",z,[t(c,{class:"text-subtitle2 text-weight-regular"},{default:i(()=>[I("Completa los siguientes campos para crear una nueva ubicaci\xF3n.")]),_:1}),h("div",T,[O,t(U,{clearable:"",dense:"",modelValue:e.inputInfo.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.inputInfo.name=l),class:"q-mb-md",hint:"requerido",rules:e.inputRulesDictionary.name},null,8,["modelValue","rules"])])])]),_:1}),t(y,{align:"right"},{default:i(()=>[t(D,{label:"Agregar",size:"0.85rem",color:"primary",dense:"",padding:"sm lg",outline:"",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:e.addLocation,disable:!e.validateForm()},null,8,["onClick","disable"]),t(D,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",padding:"sm lg",outline:"",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:e.closeDialog},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var G=q(E,[["render",x]]);const H=L({name:"LocationsPage",components:{PageTitle:Q,PrimaryButton:C,FilterBar:S,DetailsTable:M,DialogNewLocation:G},setup(){const e=f(o());function o(){const a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),s=window.innerWidth<768;return a||s}window.addEventListener("resize",()=>{e.value=o()});const r=f(!1),n=[{name:"index",label:"#",field:"index"},{name:"name",label:"Nombre",field:"name",align:"left"},{name:"created_at",label:"Fecha de creaci\xF3n",field:"created_at",format:a=>u(a),sortable:!0,sort:(a,s)=>new Date(s)-new Date(a),align:"left"},{name:"updated_at",label:"Ultima fecha de modificaci\xF3n",field:"updated_at",format:a=>a==null?"Sin modificar":u(a),sortable:!0,sort:(a,s)=>new Date(s)-new Date(a),align:"left"},{name:"actions",label:"",align:"left"}],p=f([]),d=B(),c=f(!1);l();function l(){c.value=!0;try{N.get("./locations").then(a=>{const s=a.data;s.length>0?g(s):s.length==0&&(d.clearDataApi(),c.value=!1)}).catch(a=>{console.log(a)})}catch(a){console.log(a)}}function g(a=null){a!==null&&d.setDataApi(a),p.value=d.getDataApi,c.value=!1}function u(a){return $.formatDate(a,"DD/MMMM/YYYY - HH:mm",{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]})}return{isMobile:e,locationColumns:n,locationRows:p,loadingState:c,stateDialogNewLocation:r,dataApiStore:d,getAllLocations:l,formatDate:u,setLocations:g}},methods:{activateDialogNewLocation(){this.$refs.dialogNewLocationRef.openDialog()},emitEventUpdateNotifications(){this.$emit("updateNotifications")}}}),Y={key:0},j={key:1};function J(e,o,r,n,p,d){const c=m("PageTitle"),l=m("PrimaryButton"),g=m("DialogNewLocation"),u=m("q-section"),a=m("FilterBar"),s=m("DetailsTable");return b(),A(P,null,{default:i(()=>[t(u,{class:"flex justify-between q-pa-md"},{default:i(()=>[t(c,{label:"Ubicaciones"}),e.isMobile?(b(),_("div",Y,[t(v,{flat:""},{default:i(()=>[t(l,{flat:"",icon:"add",class:"q-mx-sm",onClick:e.activateDialogNewLocation},null,8,["onClick"]),t(g,{ref:"dialogNewLocationRef",onLocationAdded:o[0]||(o[0]=()=>{e.getAllLocations(),e.emitEventUpdateNotifications()})},null,512),t(l,{flat:"",icon:"more_vert",class:"q-mx-sm"})]),_:1})])):(b(),_("div",j,[t(v,{flat:""},{default:i(()=>[t(l,{label:"Agregar Nueva",icon:"add",class:"q-mx-sm",onClick:e.activateDialogNewLocation},null,8,["onClick"]),t(g,{ref:"dialogNewLocationRef",onLocationAdded:o[1]||(o[1]=()=>{e.getAllLocations(),e.emitEventUpdateNotifications()})},null,512),t(l,{flat:"",icon:"more_vert",class:"q-mx-sm"})]),_:1})]))]),_:1}),t(u,null,{default:i(()=>[t(a,{onGetAllData:e.getAllLocations,onRealodData:e.setLocations},null,8,["onGetAllData","onRealodData"])]),_:1}),t(u,null,{default:i(()=>[t(s,{section:"locations",label:"Ubicaciones",columns:e.locationColumns,rows:e.locationRows,loading:e.loadingState,onElementDeleted:o[2]||(o[2]=()=>{e.getAllLocations(),e.emitEventUpdateNotifications()})},null,8,["columns","rows","loading"])]),_:1})]),_:1})}var fe=q(H,[["render",J]]);export{fe as default};
