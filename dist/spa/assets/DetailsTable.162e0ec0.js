import{b as M,c as A,Q as I}from"./QTable.d3ac5408.js";import{d as T,r as n,I as H,x as O,w as j,_ as G,y as c,J as q,f as l,C as s,E as C,K as h,z as v,Q as u,L as D,B as J,N as m,F as z,M as K}from"./index.d76d729d.js";import{u as W,Q as k}from"./use-quasar.8b1fb4cd.js";import{a as P,b as f}from"./QPage.90f527e3.js";import{Q as b}from"./QInput.256b5391.js";import{Q as B}from"./QTooltip.e068c045.js";import{api as R}from"./axios.d5763ff0.js";const X=T({name:"DetailsTable",props:{label:{type:String},section:{type:String},rows:{type:Array},columns:{type:Array},loading:{type:Boolean}},setup(e){var V;const a=n(r());function r(){const o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),w=window.innerWidth<768;return o||w}window.addEventListener("resize",()=>{a.value=r()});const i=H(),g=W(),y=O(),t=n(e.label),d=n(e.section),p=n(e.rows);console.log(p.value),j(()=>e.rows,o=>{p.value=o,p.value.forEach((w,$)=>{w.index=$+1})});const U=n(((V=e==null?void 0:e.columns[2])==null?void 0:V.name)==="properties"),Q=n(!1),S=n(!1),E=n(null),F=n(null),N=n([{label:"Descripci\xF3n",key:"description",value:!1},{label:"Fabricante",key:"manufacturer",value:!1},{label:"Modelo",key:"model",value:!1},{label:"Numero serial",key:"serial_number",value:!1},{label:"Lugar de compra",key:"purchase_from",value:!1},{label:"Fecha de compra",key:"purchase_date",value:!1},{label:"Costo",key:"cost",value:!1},{label:"Garantia",key:"warranty_info",value:!1},{label:"Fecha de expiracion de garantia",key:"warranty_expiration_date",value:!1},{label:"Ubicacion",key:"location",value:!1},{label:"Ubicacion (informacion extra)",key:"location_extra_info",value:!1},{label:"Empleado",key:"current_employee",value:!1},{label:"S/O",key:"operating_system",value:!1},{label:"Direccion IP",key:"ip_address",value:!1},{label:"Memoria RAM",key:"ram",value:!1},{label:"Estado de red",key:"network_status",value:!1},{label:"Cantidad",key:"quantity",value:!1},{label:"Ultima cantidad de salida",key:"quantity_last_out",value:!1},{label:"Fecha de ultima cantidad de salida",key:"date_quantity_last_out",value:!1},{label:"Cantidad de ultimo restock",key:"quantity_last_restock",value:!1},{label:"Fecha de ultimo restock",key:"date_last_restock",value:!1}]),L=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,x=n({name:[o=>!!o||"* Requerido",o=>o.length<30||"Porfavor usa un maximo de 30 caracteres",o=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(o)||"No se permiten caracteres especiales"],username:[o=>!!o||"* Requerido",o=>o.length<30||"Porfavor usa un maximo de 30 caracteres",o=>!/[!@#$%^&*()_+={}|:\;',.<>?~`]/gi.test(o)||"No se permiten caracteres especiales"],email:[o=>!!o||"* Requerido",o=>o.length<30||"Porfavor usa un maximo de 30 caracteres",o=>L.test(o)||"Ingresa un correo electr\xF3nico v\xE1lido"],password:[o=>!!o||"* Requerido",o=>o.length<30||"Porfavor usa un maximo de 30 caracteres"]});return{userStore:i,$q:g,isMobile:a,route:y,nameSection:d,pageLabel:t,records:p,dialogModify:Q,dialogDelete:S,currentData:F,checkBoxProperties:N,isCategory:U,inputConfirmDelete:E,inputRulesDictionary:x,pagination:n({rowsPerPage:0})}},methods:{formatProperties(e){let a="";return e.map((r,i)=>{i===e.length-1&&(a+=r.name),a+=r.name+", "}),a},redirectToAsset(e){this.$router.push({path:`inventario/${e}`})},openModifyDialog(e){this.dialogModify=!0;const a=this.records.find(r=>r._id===e);if(console.log(a),this.currentData=a,this.isCategory&&a.properties){const r=a.properties;this.checkBoxProperties.map((i,g)=>{const y=r.some(t=>t.key===i.key);this.checkBoxProperties[g].value=y})}},closeModifyDialog(){this.dialogModify=!1,this.currentData=null,this.$emit("elementDeleted")},saveRecord(e){const a=this.currentData;if(this.isCategory){const r=this.checkBoxProperties.map(i=>{if(i.value==!0)return{name:i.label,key:i.key}}).filter(i=>i!==void 0);a.properties=r}a.updated_at=new Date,R.patch(`./${this.nameSection}/update/${a._id}`,a).then(r=>{r.data?(this.$q.notify({type:"positive",message:"Guardado correctamente.",timeout:2e3}),this.dialogModify=!1,this.currentData=null):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(r=>{console.log(r),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})},openDeleteDialog(e){this.inputConfirmDelete=null,this.dialogDelete=!0;const a=this.records.find(r=>r._id===e);this.currentData=a},closeDeleteDialog(e){this.dialogDelete=!1,this.currentData=null},deleteRecord(e){R.delete(`./${this.nameSection}/delete/${e}`).then(a=>{a.status===200?(this.$q.notify({type:"warning",message:"Borrado correctamente.",timeout:2e3}),this.dialogDelete=!1,this.currentData=null,this.$emit("elementDeleted")):this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})}).catch(a=>{console.log(a),this.$q.notify({type:"negative",message:"Ha ocurrido un error.",timeout:2e3})})},validateForm(){if(this.currentData){const e=[];return Object.keys(this.currentData).map(a=>{if(this.inputRulesDictionary[a]){const r=this.inputRulesDictionary[a];for(const i of r)i(this.currentData[a])!==!0?e.push(!1):e.push(!0)}}),!e.includes(!1)}else return!1}}}),Y={class:"text-h6"},Z=m("div",{class:"q-pt-lg q-pb-md"},"Propiedades",-1),_={class:"row flex justify-between"},ee={class:"text-h6"},ae=m("div",{class:"text-center text-subtitle1 text-weight-regular"}," \xBFEstas seguro de borrar este registro? ",-1),te=m("div",{class:"text-subtitle2 text-weight-regular q-pt-sm"}," Ten en cuenta que una vez borrado no sera posible recuperarlo. ",-1),le={class:"text-subtitle2 text-weight-regular q-pt-md"},oe={class:"text-red text-weight-medium"},re={class:"full-width q-pt-sm q-pb-md"};function se(e,a,r,i,g,y){return c(),q(z,null,[l(A,{flat:"",bordered:"",rows:e.rows,columns:e.columns,loading:e.loading,"loading-label":"Cargando","row-key":"name","table-header-style":"font-weight: 100;",class:"q-pt-md","no-data-label":"No se encontraron datos","rows-per-page-label":"Cantidad de registros","rows-per-page-options":[8,10,20,30,0],style:J({height:e.isMobile?"68vh":"63vh"})},{"body-cell-properties":s(t=>[l(M,{style:{"max-width":"700px","overflow-x":"hidden"}},{default:s(()=>{var d;return[C(h(e.formatProperties((d=t.row)==null?void 0:d.properties)),1)]}),_:2},1024)]),"body-cell-actions":s(t=>[l(M,{style:{width:"30%"}},{default:s(()=>[e.section=="administrators"?(c(),v(u,{key:0,label:"Cambiar contrase\xF1a","icon-right":"lock_open",outline:"",size:"0.75rem",class:"q-mx-xs",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>e.openModifyDialog(t.row._id)},null,8,["onClick"])):D("",!0),l(u,{label:"Editar","icon-right":"edit",color:"secondary",outline:"",size:"0.75rem",class:"q-mx-xs",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>e.openModifyDialog(t.row._id)},null,8,["onClick"]),l(u,{label:"Borrar","icon-right":"delete",color:"red",outline:"",size:"0.75rem",class:"q-mx-xs",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:d=>e.openDeleteDialog(t.row._id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","columns","loading","style"]),l(B,{modelValue:e.dialogModify,"onUpdate:modelValue":a[7]||(a[7]=t=>e.dialogModify=t),persistent:""},{default:s(()=>[l(P,{class:"q-pa-md",style:{width:"700px","max-width":"80vw","max-height":"80vh"}},{default:s(()=>[l(k,{align:"right",class:"q-py-none"},{default:s(()=>[l(u,{icon:"close",color:"black",flat:"",round:"",onClick:a[0]||(a[0]=t=>e.closeModifyDialog(e.currentData._id)),class:"q-py-none"})]),_:1}),l(f,{class:"q-pt-none q-pb-sm",style:{"border-bottom":"1px solid #e9e9e9"}},{default:s(()=>[m("div",Y,h(e.pageLabel),1)]),_:1}),e.pageLabel==="Categorias"?(c(),v(f,{key:0},{default:s(()=>[l(b,{modelValue:e.currentData.name,"onUpdate:modelValue":a[1]||(a[1]=t=>e.currentData.name=t),label:"Nombre",onChange:e.validateForm,rules:e.inputRulesDictionary.name},null,8,["modelValue","onChange","rules"]),Z,m("div",_,[(c(!0),q(z,null,K(e.checkBoxProperties,(t,d)=>(c(),q("div",{class:"q-ma-sm col-md-5 col-11",key:d},[l(I,{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,label:t.label,dense:""},null,8,["modelValue","onUpdate:modelValue","label"])]))),128))])]),_:1})):D("",!0),e.pageLabel==="Ubicaciones"?(c(),v(f,{key:1},{default:s(()=>[l(b,{modelValue:e.currentData.name,"onUpdate:modelValue":a[2]||(a[2]=t=>e.currentData.name=t),label:"Nombre"},null,8,["modelValue"])]),_:1})):D("",!0),e.pageLabel==="Administradores"?(c(),v(f,{key:2},{default:s(()=>[l(b,{clearable:"",dense:"",modelValue:e.currentData.username,"onUpdate:modelValue":[a[3]||(a[3]=t=>e.currentData.username=t),e.validateForm],label:"Nombre",class:"q-mb-md",hint:"requerido",rules:e.inputRulesDictionary.username},null,8,["modelValue","rules","onUpdate:modelValue"]),l(b,{clearable:"",dense:"",modelValue:e.currentData.email,"onUpdate:modelValue":[a[4]||(a[4]=t=>e.currentData.email=t),e.validateForm],label:"Correo electronico",type:"email",class:"q-mb-md",hint:"requerido",rules:e.inputRulesDictionary.email},null,8,["modelValue","rules","onUpdate:modelValue"])]),_:1})):D("",!0),l(k,{align:"right"},{default:s(()=>[l(u,{label:"Guardar",size:"0.85rem",color:"secondary",dense:"",padding:"sm lg",outline:"",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:a[5]||(a[5]=t=>e.saveRecord(e.currentData._id)),disabled:!e.validateForm()},null,8,["disabled"]),l(u,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",padding:"sm lg",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:a[6]||(a[6]=t=>e.closeModifyDialog(e.currentData._id))})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:e.dialogDelete,"onUpdate:modelValue":a[12]||(a[12]=t=>e.dialogDelete=t),persistent:""},{default:s(()=>[l(P,{class:"q-pa-md",style:{width:"500px","max-width":"80vw"}},{default:s(()=>[l(k,{align:"right",class:"q-py-none"},{default:s(()=>[l(u,{icon:"close",color:"black",flat:"",round:"",onClick:a[8]||(a[8]=t=>e.closeDeleteDialog(e.currentData._id)),class:"q-py-none"})]),_:1}),l(f,{class:"q-pt-none q-pb-md",style:{"border-bottom":"1px solid #e9e9e9"}},{default:s(()=>[m("div",ee,"Borrar "+h(e.pageLabel),1)]),_:1}),l(f,{class:"q-pt-md q-pb-sm flex justify-start"},{default:s(()=>[ae,te,m("div",le,[C(" Escribe "),m("span",oe,"delete "+h(e.currentData.name?e.currentData.name:e.currentData.username?e.currentData.username:"Error"),1),C(" a continuaci\xF3n para confirmar. ")]),m("div",re,[l(b,{modelValue:e.inputConfirmDelete,"onUpdate:modelValue":a[9]||(a[9]=t=>e.inputConfirmDelete=t),outlined:"",dense:"",class:"full-width"},null,8,["modelValue"])])]),_:1}),l(k,{align:"right"},{default:s(()=>[l(u,{label:"Confirmar",size:"0.85rem",color:"red",dense:"",padding:"sm lg",outline:"",style:{"border-radius":"10px","text-transform":"capitalize"},disabled:e.inputConfirmDelete!==`delete ${e.currentData.name?e.currentData.name:e.currentData.username?e.currentData.username:"Error"}`,onClick:a[10]||(a[10]=t=>e.deleteRecord(e.currentData._id))},null,8,["disabled"]),l(u,{label:"Cancelar",size:"0.85rem",flat:"",dense:"",padding:"sm lg",style:{"border-radius":"10px","text-transform":"capitalize"},onClick:a[11]||(a[11]=t=>e.closeDeleteDialog(e.currentData._id))})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var fe=G(X,[["render",se]]);export{fe as D};
